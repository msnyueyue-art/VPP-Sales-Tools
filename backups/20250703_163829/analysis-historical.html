<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†å²æ•°æ®æ·±åº¦åˆ†æ - U Energy</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="stylesheet" href="components/common-styles.css">
    <link rel="stylesheet" href="components/i18n.css">
    <link rel="stylesheet" href="components/notification-center.css">
    <link rel="stylesheet" href="components/header-nav.css">
    <link rel="stylesheet" href="components/standard-layout.css">
    <script src="components/i18n.js"></script>
    <script src="components/simple-message-icon.js"></script>
    <script src="components/header-nav.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000 !important;
        }

        .container {
            max-width: 95%;
            margin: 0 auto;
            padding: 120px 10px 24px;
            min-height: calc(100vh - 200px);
        }

        /* Page Header */
        .page-header {
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 36px;
            font-weight: 200;
            color: var(--color-text);
            margin: 0;
            letter-spacing: -1px;
        }

        .analysis-toggle {
            display: inline-flex;
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 4px;
            gap: 4px;
        }

        .toggle-btn {
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px 24px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.08);
            color: rgba(255, 255, 255, 0.8);
        }

        .toggle-btn.active {
            background: var(--color-primary);
            color: #000;
            border-color: var(--color-primary);
            box-shadow: 0 0 12px rgba(0, 255, 136, 0.3);
        }

        .toggle-btn.active::after {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: 8px;
            padding: 1px;
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.5;
        }

        /* Analysis Dimension Tabs */
        .dimension-tabs {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 16px;
        }

        .dimension-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .dimension-tab:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }

        .dimension-tab.active {
            background: linear-gradient(135deg, rgba(0,185,107,0.1), rgba(30,127,255,0.1));
            border-color: var(--color-primary);
        }

        .dimension-tab.active::after {
            content: '';
            position: absolute;
            bottom: -17px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 3px;
            background: var(--color-primary);
            border-radius: 2px;
        }

        .dimension-icon {
            font-size: 20px;
        }

        .dimension-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--color-text);
        }

        /* Content Section */
        .dimension-content {
            display: none;
        }

        .dimension-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Analysis Cards */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        /* Large Summary Card */
        .summary-card {
            background: var(--color-bg-card);
            border-radius: var(--radius);
            border: 1.5px solid var(--color-border);
            padding: 32px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
        }
        
        .summary-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
        }
        
        .summary-card-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-text);
            letter-spacing: -0.5px;
        }
        
        .summary-card-value {
            font-size: 48px;
            font-weight: 700;
            color: var(--color-primary);
            letter-spacing: -1px;
        }
        
        .summary-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
        }
        
        .summary-metric {
            padding: 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.08);
            transition: all 0.3s ease;
        }
        
        .summary-metric:hover {
            background: rgba(255,255,255,0.05);
            transform: translateY(-2px);
            border-color: rgba(255,255,255,0.15);
        }
        
        .summary-metric-label {
            font-size: 13px;
            color: var(--color-text-secondary);
            margin-bottom: 6px;
        }
        
        .summary-metric-value {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 2px;
        }
        
        .summary-metric-subtitle {
            font-size: 11px;
            color: var(--color-text-secondary);
        }
        
        .summary-metric-trend {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 6px;
            font-size: 12px;
        }
        
        .summary-metric-trend.positive {
            color: var(--color-primary);
        }
        
        .summary-metric-trend.negative {
            color: #ff3b30;
        }
        
        .summary-metric-trend.warning {
            color: #ff9500;
        }
        
        .summary-metric.positive .summary-metric-value {
            color: var(--color-primary);
        }
        
        .summary-metric.negative .summary-metric-value {
            color: #ff3b30;
        }
        
        .summary-metric.warning .summary-metric-value {
            color: #ff9500;
        }
        
        /* Custom scrollbar for insight content */
        .insight-content::-webkit-scrollbar {
            width: 6px;
        }

        .insight-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .insight-content::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 136, 0.3);
            border-radius: 3px;
        }

        .insight-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 136, 0.5);
        }

        @media (max-width: 1200px) {
            .summary-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .summary-card-header {
                flex-direction: column;
                gap: 16px;
            }
            
            .summary-card-value {
                font-size: 36px;
            }
            
            .summary-metrics {
                grid-template-columns: 1fr;
            }
        }

        .analysis-card {
            background: var(--color-bg-card);
            border-radius: var(--radius);
            border: 1.5px solid var(--color-border);
            padding: 24px;
            transition: all 0.3s ease;
        }

        .analysis-card:hover {
            border-color: var(--color-primary);
            box-shadow: 0 4px 16px rgba(0, 185, 107, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
        }

        .card-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .card-subtitle {
            font-size: 13px;
            color: var(--color-text-secondary);
            margin-bottom: 16px;
        }

        .card-trend {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }

        .trend-positive {
            color: var(--color-primary);
        }

        .trend-negative {
            color: #ff3b30;
        }

        .trend-neutral {
            color: rgba(255,255,255,0.7);
        }

        /* Chart Container */
        .chart-container {
            background: var(--color-bg-card);
            border-radius: var(--radius);
            border: 1.5px solid var(--color-border);
            padding: 24px;
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 20px;
        }

        .chart-box {
            width: 100%;
            height: 400px;
        }

        /* Risk Matrix */
        .risk-matrix {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 20px;
        }

        .risk-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .risk-item:hover {
            background: rgba(255,255,255,0.05);
            transform: scale(1.02);
        }

        .risk-level {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
        }

        .risk-level.low {
            background: rgba(0,185,107,0.2);
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
        }

        .risk-level.medium {
            background: rgba(255,149,0,0.2);
            color: #ff9500;
            border: 2px solid #ff9500;
        }

        .risk-level.high {
            background: rgba(255,59,48,0.2);
            color: #ff3b30;
            border: 2px solid #ff3b30;
        }

        .risk-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .risk-desc {
            font-size: 12px;
            color: var(--color-text-secondary);
        }

        /* Insight Box */
        .insight-box {
            background: linear-gradient(135deg, rgba(0,185,107,0.05), rgba(30,127,255,0.05));
            border: 2px solid rgba(0,185,107,0.2);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .insight-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-content {
            font-size: 14px;
            line-height: 1.8;
            color: var(--color-text);
        }

        /* Recommendation Cards */
        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }

        .recommendation-card {
            background: rgba(30,127,255,0.05);
            border: 1.5px solid rgba(30,127,255,0.2);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            background: rgba(30,127,255,0.08);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(30,127,255,0.2);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .recommendation-icon {
            width: 48px;
            height: 48px;
            background: rgba(30,127,255,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .recommendation-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .recommendation-impact {
            font-size: 12px;
            color: var(--color-accent);
        }

        .recommendation-desc {
            font-size: 13px;
            color: var(--color-text-secondary);
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .recommendation-action {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: rgba(30,127,255,0.2);
            border: 1px solid rgba(30,127,255,0.3);
            border-radius: 8px;
            color: var(--color-accent);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .recommendation-action:hover {
            background: rgba(30,127,255,0.3);
            transform: translateX(4px);
        }

        /* Time Dimension Selector */
        .time-dimension-container {
            margin-bottom: 24px;
            padding: 20px 24px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .time-dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .time-dimension-label {
            font-size: 16px;
            font-weight: 500;
            color: var(--color-text);
        }

        .time-dimension-tabs {
            display: flex;
            gap: 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 4px;
        }

        .time-dimension-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: var(--color-text-secondary);
            font-size: 14px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .time-dimension-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .time-dimension-btn:hover {
            background: rgba(255,255,255,0.08);
            color: var(--color-text);
            transform: translateY(-1px);
        }

        .time-dimension-btn:hover::before {
            left: 100%;
        }

        .time-dimension-btn.active {
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            color: #fff;
            box-shadow: 0 4px 12px rgba(0,185,107,0.3);
        }

        .time-dimension-btn.active::before {
            display: none;
        }

        /* Time Range Selector (for individual charts) */
        .time-range-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 4px;
        }

        .time-range-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            color: var(--color-text-secondary);
            font-size: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-range-btn:hover {
            background: rgba(255,255,255,0.08);
            color: var(--color-text);
        }

        .time-range-btn.active {
            background: var(--color-primary);
            color: #fff;
        }

        /* Comparative Analysis */
        .comparison-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .comparison-card {
            background: var(--color-bg-card);
            border-radius: var(--radius);
            border: 1.5px solid var(--color-border);
            padding: 24px;
            position: relative;
            overflow: hidden;
        }

        .comparison-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .comparison-card.better::before {
            background: var(--color-primary);
        }

        .comparison-card.worse::before {
            background: #ff3b30;
        }

        .comparison-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .comparison-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
        }

        .comparison-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .comparison-badge.better {
            background: rgba(0,185,107,0.2);
            color: var(--color-primary);
        }

        .comparison-badge.worse {
            background: rgba(255,59,48,0.2);
            color: #ff3b30;
        }

        .comparison-metrics {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-label {
            font-size: 14px;
            color: var(--color-text-secondary);
        }

        .metric-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
        }

        /* Advanced Filter Panel */
        .filter-panel {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            display: none;
        }

        .filter-panel.active {
            display: block;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            color: var(--color-text-secondary);
        }

        .filter-select {
            padding: 8px 12px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--color-text);
            font-size: 14px;
            cursor: pointer;
        }

        .filter-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .filter-btn {
            padding: 8px 20px;
            border: 1px solid rgba(255,255,255,0.2);
            background: transparent;
            color: var(--color-text);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .filter-btn:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.3);
        }

        .filter-btn.primary {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: #fff;
        }

        .filter-btn.primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-1px);
        }

        /* Export Options */
        .export-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: rgba(0,0,0,0.9);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 8px;
            min-width: 200px;
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
        }

        .export-menu.active {
            display: block;
        }

        .export-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-option:hover {
            background: rgba(255,255,255,0.1);
        }

        .export-icon {
            font-size: 18px;
        }

        .export-text {
            font-size: 14px;
            color: var(--color-text);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .dimension-tabs {
                flex-wrap: wrap;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .comparison-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 100px 10px 24px;
            }

            .page-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .page-title {
                font-size: 28px;
            }

            .recommendation-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header Container -->
    <div id="headerContainer"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">è™šæ‹Ÿç”µå‚æ·±åº¦åˆ†æ</h1>
            <div class="analysis-toggle">
                <button class="toggle-btn" onclick="switchAnalysisMode('realtime', this)">å®æ—¶åˆ†æ</button>
                <button class="toggle-btn active" onclick="switchAnalysisMode('historical', this)">å†å²åˆ†æ</button>
            </div>
        </div>

        <!-- Time Dimension Selector (only show when historical is selected) -->
        <div class="time-dimension-container" id="timeDimensionContainer">
            <div class="time-dimension-header">
                <span class="time-dimension-label">æ—¶é—´ç»´åº¦</span>
                <div class="time-dimension-tabs">
                    <button class="time-dimension-btn active" data-range="24h" onclick="switchTimeDimension('24h', this)">è¿‘24å°æ—¶</button>
                    <button class="time-dimension-btn" data-range="7d" onclick="switchTimeDimension('7d', this)">è¿‘7å¤©</button>
                    <button class="time-dimension-btn" data-range="30d" onclick="switchTimeDimension('30d', this)">è¿‘30å¤©</button>
                </div>
            </div>
        </div>

        <!-- Dimension Tabs -->
        <div class="dimension-tabs">
            <div class="dimension-tab active" onclick="switchDimension('price-forecast', this)">
                <span class="dimension-icon">ğŸ“ˆ</span>
                <span class="dimension-name">ä»·æ ¼é¢„æµ‹</span>
            </div>
            <div class="dimension-tab" onclick="switchDimension('operation-analysis', this)">
                <span class="dimension-icon">âš™ï¸</span>
                <span class="dimension-name">æ“ä½œåˆ†æ</span>
            </div>
            <div class="dimension-tab" onclick="switchDimension('profit-analysis', this)">
                <span class="dimension-icon">ğŸ’°</span>
                <span class="dimension-name">è·åˆ©åˆ†æ</span>
            </div>
            <div class="dimension-tab" onclick="switchDimension('user-analysis', this)">
                <span class="dimension-icon">ğŸ‘¤</span>
                <span class="dimension-name">ç”¨æˆ·åˆ†æ</span>
            </div>
        </div>

        <!-- Price Forecast Content -->
        <div class="dimension-content active" id="price-forecast">
            <!-- Top Section: Half-Half Layout -->
            <div style="display: flex; gap: 24px; margin-bottom: 24px;">
                <!-- Left Half: Summary Card -->
                <div class="summary-card" style="flex: 1; margin: 0; padding: 16px; height: 340px;">
                    <div class="summary-card-header" style="margin-bottom: 12px;">
                        <h2 class="summary-card-title" style="font-size: 18px;">ä»·æ ¼é¢„æµ‹å‡†ç¡®æ€§</h2>
                        <div class="summary-card-value" style="font-size: 32px;">94.7%</div>
                    </div>
                    <div class="summary-metrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="summary-metric positive">
                            <div class="summary-metric-label">å‡†ç¡®é¢„æµ‹</div>
                            <div class="summary-metric-value">6,794</div>
                            <div class="summary-metric-subtitle">å…±7,176æ¬¡é¢„æµ‹ä¸­</div>
                            <div class="summary-metric-trend positive">
                                <span>âœ“</span>
                                <span>å‡†ç¡®é¢„æµ‹å æ¯”94.7%</span>
                            </div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-metric-label">è½»å¾®åå·®</div>
                            <div class="summary-metric-value">287</div>
                            <div class="summary-metric-subtitle">åå·®â‰¤5% (4.0%)</div>
                            <div class="summary-metric-trend positive">
                                <span>~</span>
                                <span>å¯æ¥å—èŒƒå›´</span>
                            </div>
                        </div>
                        <div class="summary-metric negative">
                            <div class="summary-metric-label">é‡å¤§åå·®</div>
                            <div class="summary-metric-value">95</div>
                            <div class="summary-metric-subtitle">åå·®>5% (1.3%)</div>
                            <div class="summary-metric-trend negative">
                                <span>!</span>
                                <span>éœ€è¦å…³æ³¨</span>
                            </div>
                        </div>
                        <div class="summary-metric warning">
                            <div class="summary-metric-label">å¹³å‡åå·®</div>
                            <div class="summary-metric-value">$8.4/MWh</div>
                            <div class="summary-metric-subtitle">ç»å¯¹ä»·æ ¼åå·®</div>
                            <div class="summary-metric-trend positive">
                                <span>â–¼</span>
                                <span>å¹³å‡åå·®ç‡ä¸º1.9%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Half: Analysis Conclusion -->
                <div class="insight-box" style="flex: 1; margin: 0; height: 350px; display: flex; flex-direction: column;">
                    <div class="insight-title" style="flex-shrink: 0;">
                        <span>ğŸ¯</span>
                        <span>åˆ†æç»“è®º</span>
                    </div>
                    <div class="insight-content" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding-right: 10px; color: #fff;">
                        <strong style="font-size: 16px; color: #fff;">âœ¨ ä¼˜ç§€è¡¨ç°</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>æ•´ä½“å‡ºè‰²ï¼š</strong>æˆ‘ä»¬çš„ä»·æ ¼é¢„æµ‹æ¨¡å‹éå¸¸å‡†ï¼Œå‡†ç¡®ç‡é«˜è¾¾<span style="color: #00ff88; font-weight: 600;">94.7%</span>ï¼Œå¹³å‡åå·®åªæœ‰<span style="color: #00ff88; font-weight: 600;">1.9%</span>ã€‚</li>
                            <li><strong>è¶‹åŠ¿ç²¾å‡†ï¼š</strong>è¶‹åŠ¿é¢„æµ‹å‡†ç¡®ç‡è¾¾åˆ°äº†<span style="color: #00ff88; font-weight: 600;">96.8%</span>ï¼Œèƒ½ç²¾å‡†åˆ¤æ–­ä»·æ ¼æ˜¯æ¶¨è¿˜æ˜¯è·Œã€‚</li>
                            <li><strong>è°·å€¼é¢„æµ‹å‡†ï¼š</strong>è°·å€¼é¢„æµ‹å‡†ç¡®ç‡ä¸º<span style="color: #00ff88; font-weight: 600;">95.2%</span>ï¼Œæ¯”å³°å€¼é¢„æµ‹å‡†ç¡®ç‡ï¼ˆ93.5%ï¼‰è¿˜é«˜ã€‚</li>
                            <li><strong>é«˜å‡†ç¡®ç‡æ—¶æ®µï¼š</strong>å‡Œæ™¨2:00-6:00å’Œä¸‹åˆ14:00-18:00çš„é¢„æµ‹å‡†ç¡®ç‡è¶…è¿‡<span style="color: #00ff88; font-weight: 600;">95%</span>ã€‚</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">âš ï¸ éœ€è¦æ”¹è¿›</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>å³°ä»·æ—¶æ®µå’Œä¸­æœŸé¢„æµ‹ï¼š</strong>ä»·æ ¼è¶…è¿‡$300/MWhçš„å³°ä»·æ—¶æ®µå‡†ç¡®ç‡ä¸º<span style="color: #ff9500;">91.2%</span>ï¼Œæ¯”æ•´ä½“æ°´å¹³ä½3.5%ï¼›12å°æ—¶ä¸­æœŸé¢„æµ‹å‡†ç¡®ç‡ä»…<span style="color: #ff9500;">89.3%</span>ã€‚</li>
                            <li><strong>ä½å‡†ç¡®ç‡æ—¶æ®µï¼š</strong>æ™šé—´19:00-21:00çš„é¢„æµ‹å‡†ç¡®ç‡æ˜¯<span style="color: #ff9500;">85%</span>ï¼Œéœ€æ±‚æ³¢åŠ¨è¾ƒå¤§ï¼Œå»ºè®®è¯¥æ—¶æ®µè°¨æ…äº¤æ˜“ã€‚</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">ğŸ” é‡ç‚¹åˆ†æ</strong>
                        <div style="margin: 10px 0;">
                            <strong>åå·®æœ€å¤§æ—¶æ®µï¼š</strong>12æœˆ15æ—¥19:00-21:00ï¼Œé¢„æµ‹ä»·æ ¼$165/MWhï¼Œå®é™…ä»·æ ¼$195/MWhï¼Œåå·®ç‡ä¸º<span style="color: #ff3b30;">15.4%</span>ã€‚
                        </div>
                        
                        <strong>åŸå› ï¼š</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>éœ€æ±‚å¤§å¢ï¼š</strong>è¯¥æ—¶æ®µç”¨ç”µéœ€æ±‚æ¯”é¢„æµ‹å¢åŠ äº†18%ï¼Œä¸»è¦æ˜¯å› ä¸ºæç«¯é«˜æ¸©å¯¼è‡´ç©ºè°ƒç”¨ç”µæ¿€å¢ã€‚</li>
                            <li><strong>å‘ç”µå‡å°‘ï¼š</strong>å‘ç”µé‡æ¯”é¢„æµ‹å‡å°‘äº†12%ï¼Œä¸¤ä¸ªä¸»è¦ç‡ƒç…¤ç”µå‚ä¸´æ—¶æ£€ä¿®ï¼ŒåŒæ—¶é£ç”µå› é«˜æ¸©æ— é£å‘ç”µé‡é”å‡ã€‚</li>
                            <li><strong>å¸‚åœºå› ç´ ï¼š</strong>é‚»è¿‘åœ°åŒºç”µåŠ›çŸ­ç¼ºï¼Œè·¨åŒºåŸŸç”µåŠ›è¾“é€è¾¾åˆ°ä¸Šé™ï¼Œå¯¼è‡´æœ¬åœ°ä»·æ ¼æ€¥å‰§ä¸Šæ¶¨ã€‚</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Additional Metrics Grid -->
            <div class="analysis-grid">
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">ä»·æ ¼è¶‹åŠ¿å‡†ç¡®ç‡</span>
                    </div>
                    <div class="card-value">96.8%</div>
                    <div class="card-subtitle">æ­£ç¡®è¯†åˆ«æ¶¨è·Œè¶‹åŠ¿</div>
                    <div class="card-trend trend-positive">
                        <span>â–²</span>
                        <span>è¶‹åŠ¿åˆ¤æ–­ç²¾å‡†</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">å³°å€¼ä»·æ ¼é¢„æµ‹å‡†ç¡®ç‡</span>
                    </div>
                    <div class="card-value">91.2%</div>
                    <div class="card-subtitle">ä»·æ ¼>$300/MWhæ—¶æ®µ</div>
                    <div class="card-trend trend-negative">
                        <span>â–¼</span>
                        <span>è¾ƒæ•´ä½“ä½3.5%</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">è°·å€¼ä»·æ ¼é¢„æµ‹å‡†ç¡®ç‡</span>
                    </div>
                    <div class="card-value">97.8%</div>
                    <div class="card-subtitle">ä»·æ ¼<$50/MWhæ—¶æ®µ</div>
                    <div class="card-trend trend-positive">
                        <span>â–²</span>
                        <span>è¾ƒæ•´ä½“é«˜3.1%</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">ä¸­æœŸé¢„æµ‹å‡†ç¡®æ€§</span>
                    </div>
                    <div class="card-value">89.3%</div>
                    <div class="card-subtitle">$50/MWh&lt;ä»·æ ¼&lt;$300/MWhæ—¶æ®µ</div>
                    <div class="card-trend trend-negative">
                        <span>â–¼</span>
                        <span>è¾ƒæ•´ä½“ä½5.4%</span>
                    </div>
                </div>
            </div>

            <!-- Price Comparison Chart -->
            <div class="chart-container">
                <div class="chart-title">ä»·æ ¼å¯¹æ¯”</div>
                <div id="priceComparisonChart" class="chart-box"></div>
            </div>

            <!-- Prediction Deviation Heatmap -->
            <div class="chart-container">
                <div class="chart-title">é¢„æµ‹åå·®ç‡</div>
                <div id="predictionDeviationHeatmap" class="chart-box"></div>
            </div>

            <!-- Supply Demand Gap Analysis -->
            <div class="chart-container">
                <div class="chart-title">ä¾›éœ€ç¼ºå£åˆ†æ</div>
                <div id="supplyDemandGapChart" class="chart-box"></div>
            </div>

        </div>

        

        

        

        

        

        

        <!-- Operation Analysis Content -->
        <div class="dimension-content" id="operation-analysis">
            <div class="analysis-grid">
                <div class="analysis-card excellent">
                    <div class="card-header">
                        <span class="card-title">ğŸ¯ å–åœ¨æœ€ä½³ç‚¹</span>
                    </div>
                    <div class="card-value">142æ¬¡</div>
                    <div class="card-subtitle">å®Œç¾æ—¶æœº</div>
                    <div class="card-trend trend-positive">
                        <span>âœ¨</span>
                        <span>37.1%</span>
                    </div>
                </div>
                
                <div class="analysis-card good">
                    <div class="card-header">
                        <span class="card-title">ğŸ‘ å–çš„ä¸é”™</span>
                    </div>
                    <div class="card-value">156æ¬¡</div>
                    <div class="card-subtitle">è‰¯å¥½æ”¶ç›Š</div>
                    <div class="card-trend trend-positive">
                        <span>âœ“</span>
                        <span>40.7%</span>
                    </div>
                </div>
                
                <div class="analysis-card average">
                    <div class="card-header">
                        <span class="card-title">ğŸ˜ ä¸€èˆ¬</span>
                    </div>
                    <div class="card-value">59æ¬¡</div>
                    <div class="card-subtitle">å¯ä»¥æ”¹è¿›</div>
                    <div class="card-trend trend-warning">
                        <span>~</span>
                        <span>15.4%</span>
                    </div>
                </div>
                
                <div class="analysis-card poor">
                    <div class="card-header">
                        <span class="card-title">âŒ å–é”™äº†</span>
                    </div>
                    <div class="card-value">26æ¬¡</div>
                    <div class="card-subtitle">éœ€è¦ä¼˜åŒ–</div>
                    <div class="card-trend trend-negative">
                        <span>âš </span>
                        <span>6.8%</span>
                    </div>
                </div>
            </div>
            
            <!-- Selling Points Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <span class="chart-title">å”®ç”µæ—¶æœºåˆ†æå›¾è¡¨</span>
                    <div class="chart-controls">
                        <button class="chart-control-btn active" onclick="initializeSellingPointsChart('24h')">24å°æ—¶</button>
                        <button class="chart-control-btn" onclick="initializeSellingPointsChart('7d')">7å¤©</button>
                        <button class="chart-control-btn" onclick="initializeSellingPointsChart('30d')">30å¤©</button>
                    </div>
                </div>
                <div id="sellingPointsChart" style="width: 100%; height: 400px;"></div>
            </div>
        </div>

        <!-- Profit Analysis Content -->
        <div class="dimension-content" id="profit-analysis">
            <div style="display: flex; gap: 24px; margin-bottom: 24px;">
                <!-- Left Half: Profit Statistics -->
                <div class="summary-card" style="flex: 1; margin: 0; padding: 16px; height: 340px;">
                    <div class="summary-card-header" style="margin-bottom: 12px;">
                        <h2 class="summary-card-title" style="font-size: 18px;">è·åˆ©åˆ†æ</h2>
                        <div class="summary-card-value" style="font-size: 32px;">$156.8K</div>
                    </div>
                    <div class="summary-metrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="summary-metric positive">
                            <div class="summary-metric-label">æ—¥å‡æ”¶ç›Š</div>
                            <div class="summary-metric-value">$5,227</div>
                            <div class="summary-metric-subtitle">è¿‡å»30å¤©å¹³å‡</div>
                            <div class="summary-metric-trend positive">
                                <span>â–²</span>
                                <span>å¢é•¿15.3%</span>
                            </div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-metric-label">æœ€é«˜æ—¥æ”¶ç›Š</div>
                            <div class="summary-metric-value">$12,850</div>
                            <div class="summary-metric-subtitle">12æœˆ15æ—¥</div>
                            <div class="summary-metric-trend positive">
                                <span>â˜…</span>
                                <span>å†å²æ–°é«˜</span>
                            </div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-metric-label">æ”¶ç›Šç‡</div>
                            <div class="summary-metric-value">18.6%</div>
                            <div class="summary-metric-subtitle">å¹´åŒ–æ”¶ç›Šç‡</div>
                            <div class="summary-metric-trend positive">
                                <span>â—†</span>
                                <span>è¶…è¶Šç›®æ ‡</span>
                            </div>
                        </div>
                        <div class="summary-metric warning">
                            <div class="summary-metric-label">æ”¶ç›Šæ³¢åŠ¨</div>
                            <div class="summary-metric-value">Â±28.5%</div>
                            <div class="summary-metric-subtitle">æ ‡å‡†å·®</div>
                            <div class="summary-metric-trend warning">
                                <span>âš </span>
                                <span>æ³¢åŠ¨è¾ƒå¤§</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Half: Profit Analysis Conclusion -->
                <div class="insight-box" style="flex: 1; margin: 0; height: 350px; display: flex; flex-direction: column;">
                    <div class="insight-title" style="flex-shrink: 0;">
                        <span>ğŸ’°</span>
                        <span>è·åˆ©åˆ†æç»“è®º</span>
                    </div>
                    <div class="insight-content" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding-right: 10px; color: #fff;">
                        <strong style="font-size: 16px; color: #fff;">ğŸ“Š æ”¶ç›Šæ„æˆ</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>èƒ½é‡å¥—åˆ©ï¼š</strong>å æ€»æ”¶ç›Š<span style="color: #00ff88; font-weight: 600;">78.5%</span>ï¼Œä¸»è¦æ¥è‡ªæ—¥å†…ä»·æ ¼æ³¢åŠ¨å¥—åˆ©ã€‚</li>
                            <li><strong>å®¹é‡æœåŠ¡ï¼š</strong>å æ€»æ”¶ç›Š<span style="color: #00ff88; font-weight: 600;">15.2%</span>ï¼Œæä¾›ç”µç½‘ç¨³å®šæ€§æœåŠ¡ã€‚</li>
                            <li><strong>è¾…åŠ©æœåŠ¡ï¼š</strong>å æ€»æ”¶ç›Š<span style="color: #00ff88; font-weight: 600;">6.3%</span>ï¼ŒåŒ…æ‹¬é¢‘ç‡è°ƒèŠ‚ç­‰ã€‚</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">ğŸ’¡ ç›ˆåˆ©æ¨¡å¼åˆ†æ</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>é«˜å³°æ—¶æ®µï¼š</strong>17:00-21:00è´¡çŒ®äº†<span style="color: #00ff88;">45%</span>çš„æ—¥æ”¶ç›Šã€‚</li>
                            <li><strong>ä»·å·®åˆ©ç”¨ï¼š</strong>å¹³å‡ä¹°å–ä»·å·®è¾¾<span style="color: #00ff88;">$85/MWh</span>ï¼Œæœ‰æ•ˆåˆ©ç”¨ä»·æ ¼æ³¢åŠ¨ã€‚</li>
                            <li><strong>å¾ªç¯æ•ˆç‡ï¼š</strong>æ—¥å‡å®Œæˆ<span style="color: #00ff88;">2.3ä¸ª</span>å……æ”¾ç”µå¾ªç¯ã€‚</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">âš ï¸ é£é™©æç¤º</strong>
                        <div style="margin: 10px 0;">
                            æ”¶ç›Šæ³¢åŠ¨ç‡è¾¾28.5%ï¼Œå»ºè®®å»ºç«‹é£é™©å¯¹å†²æœºåˆ¶ã€‚æç«¯å¤©æ°”æ—¥æ”¶ç›Šå¯èƒ½ä¸ºè´Ÿå€¼ã€‚
                        </div>
                        
                        <strong>ä¼˜åŒ–æ½œåŠ›ï¼š</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>ä¼˜åŒ–å……æ”¾ç”µç­–ç•¥å¯æå‡æ”¶ç›Š10-15%</li>
                            <li>å‚ä¸æ›´å¤šè¾…åŠ©æœåŠ¡å¸‚åœºå¢åŠ ç¨³å®šæ”¶å…¥</li>
                            <li>åŠ¨æ€è°ƒæ•´å®¹é‡åˆ†é…æé«˜èµ„äº§åˆ©ç”¨ç‡</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Profit Metrics Grid -->
            <div class="analysis-grid">
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">æŠ•èµ„å›æŠ¥ç‡</span>
                    </div>
                    <div class="card-value">8.7%</div>
                    <div class="card-subtitle">æœˆåº¦ROI</div>
                    <div class="card-trend trend-positive">
                        <span>â–²</span>
                        <span>è¶…é¢„æœŸ2.1%</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">æˆæœ¬æ”¶ç›Šæ¯”</span>
                    </div>
                    <div class="card-value">1:8.7</div>
                    <div class="card-subtitle">æ¯$1æˆæœ¬äº§ç”Ÿæ”¶ç›Š</div>
                    <div class="card-trend trend-positive">
                        <span>â—†</span>
                        <span>æ•ˆç‡ä¼˜ç§€</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">ç›ˆäºå¹³è¡¡ç‚¹</span>
                    </div>
                    <div class="card-value">$45/MWh</div>
                    <div class="card-subtitle">æœ€ä½ä»·å·®è¦æ±‚</div>
                    <div class="card-trend trend-positive">
                        <span>âœ“</span>
                        <span>å®‰å…¨è¾¹é™…é«˜</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">èµ„é‡‘å›æ”¶æœŸ</span>
                    </div>
                    <div class="card-value">4.2å¹´</div>
                    <div class="card-subtitle">æŒ‰å½“å‰æ”¶ç›Šè®¡ç®—</div>
                    <div class="card-trend trend-positive">
                        <span>â–¼</span>
                        <span>ç¼©çŸ­0.8å¹´</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Analysis Content -->
        <div class="dimension-content" id="user-analysis">
            <div style="display: flex; gap: 24px; margin-bottom: 24px;">
                <!-- Left Half: User Cooperation Stats -->
                <div class="summary-card" style="flex: 1; margin: 0; padding: 16px; height: 340px;">
                    <div class="summary-card-header" style="margin-bottom: 12px;">
                        <h2 class="summary-card-title" style="font-size: 18px;">ç”¨æˆ·é…åˆåº¦ç»Ÿè®¡</h2>
                        <div class="summary-card-value" style="font-size: 32px;">78.5%</div>
                    </div>
                    <div class="summary-metrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="summary-metric positive">
                            <div class="summary-metric-label">ğŸŸ¢ ç§¯æå“åº”</div>
                            <div class="summary-metric-value">785</div>
                            <div class="summary-metric-subtitle">ç”¨æˆ·æ•° (78.5%)</div>
                            <div class="summary-metric-trend positive">
                                <span>âš¡</span>
                                <span>ç«‹å³æ‰§è¡Œ</span>
                            </div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-metric-label">ğŸŸ¡ å»¶è¿Ÿå“åº”</div>
                            <div class="summary-metric-value">138</div>
                            <div class="summary-metric-subtitle">ç”¨æˆ·æ•° (13.8%)</div>
                            <div class="summary-metric-trend">
                                <span>â±</span>
                                <span>5-15åˆ†é’Ÿå†…</span>
                            </div>
                        </div>
                        <div class="summary-metric negative">
                            <div class="summary-metric-label">ğŸŸ  éƒ¨åˆ†é…åˆ</div>
                            <div class="summary-metric-value">52</div>
                            <div class="summary-metric-subtitle">ç”¨æˆ·æ•° (5.2%)</div>
                            <div class="summary-metric-trend">
                                <span>â—</span>
                                <span>éƒ¨åˆ†æ‰§è¡Œ</span>
                            </div>
                        </div>
                        <div class="summary-metric negative">
                            <div class="summary-metric-label">ğŸ”´ æ— å“åº”</div>
                            <div class="summary-metric-value">25</div>
                            <div class="summary-metric-subtitle">ç”¨æˆ·æ•° (2.5%)</div>
                            <div class="summary-metric-trend negative">
                                <span>âœ—</span>
                                <span>éœ€è¦å…³æ³¨</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Half: User Cooperation Analysis -->
                <div class="insight-box" style="flex: 1; margin: 0; height: 350px; display: flex; flex-direction: column;">
                    <div class="insight-title" style="flex-shrink: 0;">
                        <span>ğŸ¤</span>
                        <span>ç”¨æˆ·é…åˆåˆ†æ</span>
                    </div>
                    <div class="insight-content" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding-right: 10px; color: #fff;">
                        <strong style="font-size: 16px; color: #fff;">âœ… é…åˆåº¦è¾ƒé«˜</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>æ€»ä½“é…åˆç‡ï¼š</strong><span style="color: #00ff88; font-weight: 600;">92.3%</span>çš„ç”¨æˆ·èƒ½æŒ‰å»ºè®®æ“ä½œ</li>
                            <li><strong>å³æ—¶å“åº”ï¼š</strong><span style="color: #00ff88; font-weight: 600;">78.5%</span>ç”¨æˆ·ç«‹å³æ‰§è¡Œå»ºè®®</li>
                            <li><strong>å“åº”æ—¶é—´ï¼š</strong>å¹³å‡<span style="color: #00ff88; font-weight: 600;">2.3åˆ†é’Ÿ</span>å†…å“åº”</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">âš ï¸ éœ€è¦æ”¹è¿›</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>å»¶è¿Ÿæ‰§è¡Œï¼š</strong>13.8%ç”¨æˆ·å“åº”è¾ƒæ…¢ï¼Œå½±å“æ”¶ç›Šä¼˜åŒ–</li>
                            <li><strong>éƒ¨åˆ†é…åˆï¼š</strong>5.2%ç”¨æˆ·åªæ‰§è¡Œéƒ¨åˆ†å»ºè®®</li>
                            <li><strong>æ— å“åº”ç”¨æˆ·ï¼š</strong>2.5%ç”¨æˆ·éœ€è¦é‡ç‚¹å…³æ³¨</li>
                        </ul>
                        
                        <strong style="font-size: 16px; color: #fff;">ğŸ“ˆ æ”¹è¿›å»ºè®®</strong>
                        <div style="margin: 10px 0;">
                            <strong>å…³é”®æªæ–½ï¼š</strong>å»ºç«‹ç”¨æˆ·æ¿€åŠ±æœºåˆ¶ï¼Œå¯¹é«˜é…åˆåº¦ç”¨æˆ·ç»™äºˆä¼˜å…ˆæœåŠ¡ï¼Œ
                            å¯¹ä½é…åˆåº¦ç”¨æˆ·æä¾›<span style="color: #00ff88;">ä¸ªæ€§åŒ–åŸ¹è®­</span>ã€‚
                        </div>
                        
                        <strong>å…·ä½“è¡ŒåŠ¨ï¼š</strong>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>è®¾ç½®å“åº”é€Ÿåº¦æ’è¡Œæ¦œå’Œå¥–åŠ±æœºåˆ¶</li>
                            <li>ä¸ºå»¶è¿Ÿç”¨æˆ·æ¨é€ç®€åŒ–æ“ä½œæŒ‡å¼•</li>
                            <li>å®šæœŸå›è®¿æ— å“åº”ç”¨æˆ·äº†è§£åŸå› </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- User Cooperation Metrics Grid -->
            <div class="analysis-grid">
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">æ€»ç”¨æˆ·æ•°</span>
                    </div>
                    <div class="card-value">1,000</div>
                    <div class="card-subtitle">æ´»è·ƒç”¨æˆ·</div>
                    <div class="card-trend trend-positive">
                        <span>ğŸ‘¥</span>
                        <span>åŸºç¡€è§„æ¨¡</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">å¹³å‡å“åº”æ—¶é—´</span>
                    </div>
                    <div class="card-value">2.3åˆ†é’Ÿ</div>
                    <div class="card-subtitle">ç³»ç»Ÿå»ºè®®å“åº”</div>
                    <div class="card-trend trend-positive">
                        <span>âš¡</span>
                        <span>å“åº”è¿…é€Ÿ</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">å®Œæˆç‡</span>
                    </div>
                    <div class="card-value">98.7%</div>
                    <div class="card-subtitle">å»ºè®®æ‰§è¡Œå®Œæˆç‡</div>
                    <div class="card-trend trend-positive">
                        <span>âœ“</span>
                        <span>æ‰§è¡Œä¼˜ç§€</span>
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="card-header">
                        <span class="card-title">é—®é¢˜ç”¨æˆ·</span>
                    </div>
                    <div class="card-value">25</div>
                    <div class="card-subtitle">éœ€è¦å…³æ³¨ç”¨æˆ·æ•°</div>
                    <div class="card-trend trend-neutral">
                        <span>âš ï¸</span>
                        <span>é‡ç‚¹å…³æ³¨</span>
                    </div>
                </div>
            </div>
            
            <!-- User Cooperation Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <span class="chart-title">24å°æ—¶ç”¨æˆ·é…åˆåº¦è¶‹åŠ¿</span>
                    <div class="chart-controls">
                        <button class="chart-control-btn active" onclick="initializeUserCooperationChart('24h')">24å°æ—¶</button>
                        <button class="chart-control-btn" onclick="initializeUserCooperationChart('7d')">7å¤©</button>
                        <button class="chart-control-btn" onclick="initializeUserCooperationChart('30d')">30å¤©</button>
                    </div>
                </div>
                <div id="userCooperationChart" style="width: 100%; height: 400px;"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize HeaderNav
            new HeaderNav({
                currentPage: 'analysis-historical',
                showMessageCenter: true,
                showUserAvatar: true,
                showLanguageSelector: true
            });

            // Initialize charts based on current dimension
            initializeCharts();
            
            // Initialize selling performance metrics with default time dimension
            updateSellingPerformanceMetrics('24h');
            
        });

        // Global variables
        let currentTimeDimension = '24h';
        let currentDimension = 'price-forecast';

        // Switch between historical and realtime analysis
        function switchAnalysisMode(mode, button) {
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');

            const timeDimensionContainer = document.getElementById('timeDimensionContainer');
            
            if (mode === 'historical') {
                timeDimensionContainer.style.display = 'block';
            } else if (mode === 'realtime') {
                timeDimensionContainer.style.display = 'none';
                // Redirect to today analysis page
                window.location.href = 'analysis-today.html';
            }
        }

        // Switch time dimension
        function switchTimeDimension(range, button) {
            // Update active button
            document.querySelectorAll('.time-dimension-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');

            currentTimeDimension = range;
            
            // Update all data based on new time dimension
            updateAllAnalysisData(range);
            
            // Show loading indicator
            showLoadingIndicator();
            
            // Simulate data loading delay
            setTimeout(() => {
                hideLoadingIndicator();
                updateDashboardMetrics(range);
                updateOperationMetrics(range);
                updateAllCharts(range);
                updateInsightContent(range);
            }, 500);
        }

        // Update operation analysis metrics based on time dimension
        function updateOperationMetrics(range) {
            const metricsData = {
                '24h': {
                    bestTimeTitle: 'æ—¶æœºæŠŠæ¡è¯„çº§',
                    bestTimeValue: 'Açº§',
                    bestTimeSubtitle: 'æ˜¨å¤©3æ¬¡éƒ½åœ¨é«˜ä»·æ—¶å–å‡º',
                    bestTimeTrend: 'æ—¶æœºç²¾å‡†',
                    earningsTitle: 'å–å‡ºæ—¶æœºåˆ†æ',
                    earningsValue: '17:45æœ€ä½³',
                    earningsSubtitle: 'åœ¨æ™šé«˜å³°$450æ—¶å–å‡º',
                    earningsTrend: 'æŠ“ä½æœ€é«˜ç‚¹',
                    missedTitle: 'æ—©å–æ™šå–åˆ†æ',
                    missedValue: '1æ¬¡åæ—©',
                    missedSubtitle: 'æå‰20åˆ†é’Ÿï¼Œå°‘èµš$180',
                    missedTrend: 'å¯ä»¥æ›´è€å¿ƒ',
                    suggestionTitle: 'æ”¹è¿›å»ºè®®',
                    suggestionValue: 'å…³æ³¨17:30',
                    suggestionSubtitle: 'æ™šé«˜å³°é€šå¸¸æ›´é«˜',
                    suggestionTrend: 'å»¶åè§‚å¯Ÿ'
                },
                '7d': {
                    bestTimeTitle: 'æ—¶æœºæŠŠæ¡è¯„çº§',
                    bestTimeValue: 'B+çº§',
                    bestTimeSubtitle: '12æ¬¡ä¸­8æ¬¡åœ¨åˆé€‚æ—¶æœº',
                    bestTimeTrend: 'é€æ­¥æ”¹å–„',
                    earningsTitle: 'å–å‡ºæ—¶æœºåˆ†æ',
                    earningsValue: 'é«˜å³°å‘½ä¸­ç‡67%',
                    earningsSubtitle: 'æŠ“ä½8ä¸ªé«˜å³°ï¼Œé”™è¿‡4ä¸ª',
                    earningsTrend: 'ä¸»è¦é”™è¿‡æ—©é«˜å³°',
                    missedTitle: 'æ—©å–æ™šå–åˆ†æ',
                    missedValue: 'ä¹ æƒ¯æ—©å–30åˆ†é’Ÿ',
                    missedSubtitle: 'ä¿å®ˆæ“ä½œï¼Œå°‘èµš$1,200',
                    missedTrend: 'åå‘ä¿å®ˆ',
                    suggestionTitle: 'æ”¹è¿›å»ºè®®',
                    suggestionValue: 'é‡è§†7:30å’Œ17:30',
                    suggestionSubtitle: 'åŒé«˜å³°éƒ½è¦å…³æ³¨',
                    suggestionTrend: 'æå‡è€å¿ƒ'
                },
                '30d': {
                    bestTimeTitle: 'æ—¶æœºæŠŠæ¡è¯„çº§',
                    bestTimeValue: 'Bçº§',
                    bestTimeSubtitle: '58æ¬¡ä¸­43æ¬¡åœ¨åˆé€‚æ—¶æœº',
                    bestTimeTrend: 'ç¨³å®šå‘æŒ¥',
                    earningsTitle: 'å–å‡ºæ—¶æœºåˆ†æ',
                    earningsValue: 'é«˜å³°å‘½ä¸­ç‡74%',
                    earningsSubtitle: 'æ•´ä½“è¡¨ç°å¹³ç¨³',
                    earningsTrend: 'éœ€è¦çªç ´',
                    missedTitle: 'æ—©å–æ™šå–åˆ†æ',
                    missedValue: 'ä»æ—©å–2å°æ—¶åˆ°30åˆ†é’Ÿ',
                    missedSubtitle: 'è€å¿ƒç¨‹åº¦æ˜æ˜¾æå‡',
                    missedTrend: 'å­¦ä¹ æ•ˆæœå¥½',
                    suggestionTitle: 'æ”¹è¿›å»ºè®®',
                    suggestionValue: 'ç›®æ ‡ï¼šå‘½ä¸­ç‡85%',
                    suggestionSubtitle: 'ä¸“æ³¨å·¥ä½œæ—¥17:30',
                    suggestionTrend: 'ç»§ç»­ä¼˜åŒ–'
                }
            };

            const data = metricsData[range] || metricsData['24h'];
            
            // Update best time metric
            if (document.getElementById('bestTimeTitle')) {
                document.getElementById('bestTimeTitle').textContent = data.bestTimeTitle;
                document.getElementById('bestTimeValue').textContent = data.bestTimeValue;
                document.getElementById('bestTimeSubtitle').textContent = data.bestTimeSubtitle;
                document.getElementById('bestTimeTrend').textContent = data.bestTimeTrend;
            }
            
            // Update earnings metric
            if (document.getElementById('earningsTitle')) {
                document.getElementById('earningsTitle').textContent = data.earningsTitle;
                document.getElementById('earningsValue').textContent = data.earningsValue;
                document.getElementById('earningsSubtitle').textContent = data.earningsSubtitle;
                document.getElementById('earningsTrend').textContent = data.earningsTrend;
            }
            
            // Update missed opportunities metric
            if (document.getElementById('missedTitle')) {
                document.getElementById('missedTitle').textContent = data.missedTitle;
                document.getElementById('missedValue').textContent = data.missedValue;
                document.getElementById('missedSubtitle').textContent = data.missedSubtitle;
                document.getElementById('missedTrend').textContent = data.missedTrend;
            }
            
            // Update suggestions metric
            if (document.getElementById('suggestionTitle')) {
                document.getElementById('suggestionTitle').textContent = data.suggestionTitle;
                document.getElementById('suggestionValue').textContent = data.suggestionValue;
                document.getElementById('suggestionSubtitle').textContent = data.suggestionSubtitle;
                document.getElementById('suggestionTrend').textContent = data.suggestionTrend;
            }
            
            // Update selling performance metrics
            updateSellingPerformanceMetrics(range);
        }

        // Update selling performance metrics based on time dimension
        function updateSellingPerformanceMetrics(range) {
            const sellingMetricsData = {
                '24h': {
                    total: { value: '3æ¬¡', subtitle: 'æ˜¨å¤©æ€»äº¤æ˜“æ¬¡æ•°', trend: '' },
                    good: { value: '2æ¬¡', subtitle: 'å æ¯”67%', trend: '' },
                    average: { value: '1æ¬¡', subtitle: '1æ¬¡å–æ—©ï¼Œ0æ¬¡å–æ™š', trend: '' },
                    poor: { value: '0æ¬¡', subtitle: '0æ¬¡å–æ—©ï¼Œ0æ¬¡å–æ™š', trend: '' }
                },
                '7d': {
                    total: { value: '12æ¬¡', subtitle: 'è¿‘7å¤©æ€»äº¤æ˜“æ¬¡æ•°', trend: '' },
                    good: { value: '8æ¬¡', subtitle: 'å æ¯”67%', trend: '' },
                    average: { value: '3æ¬¡', subtitle: '2æ¬¡å–æ—©ï¼Œ1æ¬¡å–æ™š', trend: '' },
                    poor: { value: '1æ¬¡', subtitle: '1æ¬¡å–æ—©ï¼Œ0æ¬¡å–æ™š', trend: '' }
                },
                '30d': {
                    total: { value: '58æ¬¡', subtitle: 'è¿‘30å¤©æ€»äº¤æ˜“æ¬¡æ•°', trend: '' },
                    good: { value: '43æ¬¡', subtitle: 'å æ¯”74%', trend: '' },
                    average: { value: '12æ¬¡', subtitle: '7æ¬¡å–æ—©ï¼Œ5æ¬¡å–æ™š', trend: '' },
                    poor: { value: '3æ¬¡', subtitle: '2æ¬¡å–æ—©ï¼Œ1æ¬¡å–æ™š', trend: '' }
                }
            };

            const data = sellingMetricsData[range] || sellingMetricsData['24h'];
            
            // Update total sellings
            if (document.getElementById('totalSellingsValue')) {
                document.getElementById('totalSellingsValue').textContent = data.total.value;
                document.getElementById('totalSellingsSubtitle').textContent = data.total.subtitle;
            }
            
            // Update good sellings
            if (document.getElementById('goodSellingsValue')) {
                document.getElementById('goodSellingsValue').textContent = data.good.value;
                document.getElementById('goodSellingsSubtitle').textContent = data.good.subtitle;
            }
            
            // Update average sellings
            if (document.getElementById('averageSellingsValue')) {
                document.getElementById('averageSellingsValue').textContent = data.average.value;
                document.getElementById('averageSellingsSubtitle').textContent = data.average.subtitle;
            }
            
            // Update poor sellings
            if (document.getElementById('poorSellingsValue')) {
                document.getElementById('poorSellingsValue').textContent = data.poor.value;
                document.getElementById('poorSellingsSubtitle').textContent = data.poor.subtitle;
            }
        }

        // Update dashboard metrics based on time dimension
        function updateDashboardMetrics(range) {
            const metricsData = {
                '24h': {
                    accuracy: '96.2%',
                    accuracyTrend: '+1.8%',
                    peakAccuracy: '93.5%',
                    peakTrend: '-2.7%',
                    deviation: '$6.2',
                    deviationTrend: '-12%',
                    trendCapture: '98.1%',
                    trendTrend: '+2.1%'
                },
                '7d': {
                    accuracy: '94.7%',
                    accuracyTrend: '+2.3%',
                    peakAccuracy: '91.2%',
                    peakTrend: '-3.5%',
                    deviation: '$8.4',
                    deviationTrend: '-15%',
                    trendCapture: '96.8%',
                    trendTrend: '+1.5%'
                },
                '30d': {
                    accuracy: '93.8%',
                    accuracyTrend: '+1.2%',
                    peakAccuracy: '89.7%',
                    peakTrend: '-4.1%',
                    deviation: '$9.8',
                    deviationTrend: '-8%',
                    trendCapture: '95.2%',
                    trendTrend: '+0.8%'
                }
            };

            const data = metricsData[range];
            
            // Update price forecast metrics
            const metrics = document.querySelectorAll('#price-forecast .analysis-card');
            if (metrics.length >= 4) {
                metrics[0].querySelector('.card-value').textContent = data.accuracy;
                metrics[0].querySelector('.card-trend span:last-child').textContent = `è¾ƒä¸ŠæœŸæå‡${data.accuracyTrend}`;
                
                metrics[1].querySelector('.card-value').textContent = data.peakAccuracy;
                metrics[1].querySelector('.card-trend span:last-child').textContent = `è¾ƒæ•´ä½“ä½${data.peakTrend}`;
                
                metrics[2].querySelector('.card-value').textContent = data.deviation;
                metrics[2].querySelector('.card-trend span:last-child').textContent = `åå·®å‡å°‘${data.deviationTrend}`;
                
                metrics[3].querySelector('.card-value').textContent = data.trendCapture;
                metrics[3].querySelector('.card-trend span:last-child').textContent = data.trendTrend;
            }
        }

        // Update all charts based on time dimension
        function updateAllCharts(range) {
            // Re-initialize charts with new data based on time range
            initializeCharts();
        }

        // Update insight content based on time dimension
        function updateInsightContent(range) {
            const insightTexts = {
                '24h': {
                    'price-forecast': `
                        <strong>24å°æ—¶é¢„æµ‹è¡¨ç°ä¼˜å¼‚ï¼š</strong>è¿‡å»24å°æ—¶å†…ï¼Œæ€»ä½“é¢„æµ‹å‡†ç¡®æ€§è¾¾96.2%ï¼Œå…¶ä¸­å‡†ç¡®é¢„æµ‹504æ¬¡ï¼Œè½»å¾®åå·®15æ¬¡ï¼Œé‡å¤§åå·®5æ¬¡ã€‚
                        å¹³å‡åå·®ç‡1.8%ï¼Œæ˜¾ç¤ºçŸ­æœŸé¢„æµ‹ç²¾åº¦æé«˜ã€‚è°·ä»·æ—¶æ®µå‡†ç¡®ç‡é«˜è¾¾98.5%ï¼Œå³°ä»·æ—¶æ®µä¸º92.8%ã€‚
                        <br><br>
                        <strong>çŸ­æœŸä¼˜åŒ–é‡ç‚¹ï¼š</strong>æ—©é«˜å³°ï¼ˆ7-9ç‚¹ï¼‰å’Œæ™šé«˜å³°ï¼ˆ17-20ç‚¹ï¼‰æ˜¯ä¸»è¦åå·®åŒºé—´ï¼Œå»ºè®®å¢åŠ è¿™äº›æ—¶æ®µçš„æ•°æ®é‡‡é›†é¢‘ç‡ï¼Œ
                        å¹¶ç‰¹åˆ«å…³æ³¨éœ€æ±‚çªå˜äº‹ä»¶çš„é¢„è­¦æœºåˆ¶ã€‚ç»§ç»­ä¿æŒå¯¹ä½è°·æ—¶æ®µçš„é«˜å‡†ç¡®é¢„æµ‹ä¼˜åŠ¿ã€‚
                    `
                },
                '7d': {
                    'price-forecast': `
                        <strong>å‘¨åº¦é¢„æµ‹è¡¨ç°åˆ†æï¼š</strong>è¿‡å»7å¤©ï¼Œæ€»ä½“é¢„æµ‹å‡†ç¡®æ€§è¾¾94.7%ï¼Œå…±1,199æ¬¡é¢„æµ‹ä¸­å‡†ç¡®1,135æ¬¡ã€‚è½»å¾®åå·®46æ¬¡ï¼ˆ4.0%ï¼‰ï¼Œé‡å¤§åå·®18æ¬¡ï¼ˆ1.5%ï¼‰ã€‚
                        å¹³å‡åå·®ç‡2.1%ï¼Œå³°ä»·é¢„æµ‹å‡†ç¡®ç‡91.2%ï¼Œè°·ä»·é¢„æµ‹å‡†ç¡®ç‡97.8%ã€‚ä¸­æœŸé¢„æµ‹ï¼ˆ12å°æ—¶ï¼‰å‡†ç¡®ç‡89.3%ã€‚
                        <br><br>
                        <strong>å…³é”®å‘ç°ï¼š</strong>å‘¨æœ«é¢„æµ‹å‡†ç¡®ç‡é«˜å‡ºå·¥ä½œæ—¥çº¦2.3%ï¼Œä¸»è¦å› ä¸ºå‘¨æœ«éœ€æ±‚æ¨¡å¼ç›¸å¯¹ç¨³å®šã€‚æç«¯ä»·æ ¼äº‹ä»¶ï¼ˆ>$300/MWhï¼‰å æ‰€æœ‰é‡å¤§åå·®çš„78%ï¼Œ
                        å»ºè®®å¼•å…¥æ°”è±¡æ•°æ®å’Œè¾“ç”µçº¿è·¯è´Ÿè½½æƒ…å†µæ¥æå‡æç«¯æƒ…å†µä¸‹çš„é¢„æµ‹èƒ½åŠ›ã€‚
                    `
                },
                '30d': {
                    'price-forecast': `
                        <strong>æœˆåº¦ç»¼åˆé¢„æµ‹è¯„ä¼°ï¼š</strong>è¿‡å»30å¤©ï¼Œæ€»ä½“é¢„æµ‹å‡†ç¡®æ€§è¾¾94.7%ï¼Œå…±7,176æ¬¡é¢„æµ‹ä¸­å‡†ç¡®6,794æ¬¡ã€‚è½»å¾®åå·®287æ¬¡ï¼ˆ4.0%ï¼‰ï¼Œé‡å¤§åå·®95æ¬¡ï¼ˆ1.3%ï¼‰ã€‚
                        å¹³å‡åå·®ç‡2.1%ï¼Œå³°ä»·é¢„æµ‹å‡†ç¡®ç‡91.2%ï¼Œè°·ä»·é¢„æµ‹å‡†ç¡®ç‡97.8%ï¼Œä¸­æœŸé¢„æµ‹å‡†ç¡®ç‡89.3%ã€‚
                        <br><br>
                        <strong>æ·±åº¦åˆ†æç»“æœï¼š</strong>94.7%çš„æ€»ä½“å‡†ç¡®æ€§è¡¨ç°ä¼˜å¼‚ï¼Œå…¶ä¸­è°·ä»·æ—¶æ®µé¢„æµ‹æœ€ä¸ºç²¾å‡†ï¼Œå¯é æ€§è¾¾97.8%ã€‚å³°ä»·æ—¶æ®µæ˜¯ä¸»è¦æ”¹è¿›ç‚¹ï¼Œ
                        95æ¬¡é‡å¤§åå·®ä¸­78%å‘ç”Ÿåœ¨æç«¯ä»·æ ¼äº‹ä»¶æœŸé—´ã€‚å»ºè®®å»ºç«‹æç«¯äº‹ä»¶ä¸“ç”¨é¢„æµ‹æ¨¡å‹ï¼Œå¢å¼ºå¤©æ°”æ•°æ®å…³è”æ€§ï¼Œé¢„è®¡å¯å°†æ€»ä½“å‡†ç¡®ç‡æå‡è‡³96%ä»¥ä¸Šã€‚
                    `
                }
            };

            const insightBox = document.querySelector(`#${currentDimension} .insight-content`);
            if (insightBox && insightTexts[range] && insightTexts[range][currentDimension]) {
                insightBox.innerHTML = insightTexts[range][currentDimension];
            }
        }

        // Show loading indicator
        function showLoadingIndicator() {
            const loader = document.createElement('div');
            loader.id = 'loadingIndicator';
            loader.innerHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                           background: rgba(0,0,0,0.8); color: #fff; padding: 20px 40px; 
                           border-radius: 8px; z-index: 9999; backdrop-filter: blur(10px);
                           display: flex; align-items: center; gap: 12px;">
                    <div style="width: 20px; height: 20px; border: 2px solid var(--color-primary); 
                               border-top: 2px solid transparent; border-radius: 50%; 
                               animation: spin 1s linear infinite;"></div>
                    <span>æ­£åœ¨æ›´æ–°æ•°æ®...</span>
                </div>
                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                </style>
            `;
            document.body.appendChild(loader);
        }

        // Hide loading indicator
        function hideLoadingIndicator() {
            const loader = document.getElementById('loadingIndicator');
            if (loader) {
                loader.remove();
            }
        }

        // Update all analysis data
        function updateAllAnalysisData(range) {
            console.log(`Updating analysis data for ${range}`);
            // This would typically make API calls to fetch new data
        }

        // Switch between dimensions
        function switchDimension(dimension, tab) {
            // Update tabs
            document.querySelectorAll('.dimension-tab').forEach(t => {
                t.classList.remove('active');
            });
            tab.classList.add('active');

            // Update content
            document.querySelectorAll('.dimension-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(dimension).classList.add('active');

            // Update current dimension
            currentDimension = dimension;

            // Refresh charts for new dimension with current time range
            setTimeout(() => {
                initializeCharts();
            }, 100);
        }

        // Initialize Price Comparison Chart
        function initializePriceComparisonChart(range = '24h') {
            const chart = echarts.init(document.getElementById('priceComparisonChart'));
            
            const dates = [];
            const actualPrices = [];
            const predictedPrices = [];
            const deviations = [];
            const priceDeviations = []; // ä»·æ ¼åå·®å€¼ï¼ˆæ­£è´Ÿï¼‰
            
            // Generate data based on time range
            let dataPoints, timeFormat;
            switch(range) {
                case '24h':
                    dataPoints = 24;
                    timeFormat = (i) => `${i}:00`;
                    break;
                case '7d':
                    dataPoints = 7 * 24;
                    timeFormat = (i) => {
                        const date = new Date();
                        date.setHours(date.getHours() - (dataPoints - 1 - i));
                        return date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit', hour: '2-digit' });
                    };
                    break;
                case '30d':
                default:
                    dataPoints = 30;
                    timeFormat = (i) => {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        return date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' });
                    };
                    break;
            }
            
            // Generate realistic price data
            for (let i = 0; i < dataPoints; i++) {
                dates.push(timeFormat(i));
                
                // Simulate daily price pattern
                let hour = range === '24h' ? i : (i % 24);
                let basePrice = 180;
                
                // Morning peak (6-9)
                if (hour >= 6 && hour <= 9) {
                    basePrice += 80 + Math.random() * 30;
                }
                // Evening peak (17-21)
                else if (hour >= 17 && hour <= 21) {
                    basePrice += 120 + Math.random() * 50;
                }
                // Night valley (0-5)
                else if (hour >= 0 && hour <= 5) {
                    basePrice -= 40 + Math.random() * 20;
                }
                // Normal hours
                else {
                    basePrice += Math.random() * 40;
                }
                
                // Add some market volatility
                const volatility = (Math.random() - 0.5) * 20;
                const actual = basePrice + volatility;
                
                // Predicted price is close to actual with small deviation
                const accuracy = 0.94 + Math.random() * 0.04; // 94-98% accuracy
                const predicted = actual * accuracy;
                
                actualPrices.push(Math.round(actual));
                predictedPrices.push(Math.round(predicted));
                deviations.push((Math.abs(actual - predicted) / actual * 100).toFixed(1));
                priceDeviations.push(Math.round(predicted - actual)); // é¢„æµ‹ä»·æ ¼å‡å®é™…ä»·æ ¼
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        return params[0].name + '<br>' +
                               params[0].marker + params[0].seriesName + ': $' + params[0].value + '/MWh<br>' +
                               params[1].marker + params[1].seriesName + ': $' + params[1].value + '/MWh<br>' +
                               'åå·®: $' + (params[1].value - params[0].value).toFixed(0) + '/MWh (' + 
                               ((params[1].value - params[0].value) / params[0].value * 100).toFixed(1) + '%)';
                    }
                },
                legend: {
                    data: ['å®é™…ä»·æ ¼', 'é¢„æµ‹ä»·æ ¼'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'ä»·æ ¼ ($/MWh)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        formatter: '${value}'
                    },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'å®é™…ä»·æ ¼',
                        type: 'line',
                        data: actualPrices,
                        smooth: true,
                        lineStyle: { color: '#00ff88', width: 2 },
                        itemStyle: { color: '#00ff88' },
                        symbolSize: 6
                    },
                    {
                        name: 'é¢„æµ‹ä»·æ ¼',
                        type: 'line',
                        data: predictedPrices,
                        smooth: true,
                        lineStyle: { 
                            color: '#00aaff', 
                            width: 2,
                            type: 'dashed'
                        },
                        itemStyle: { color: '#00aaff' },
                        symbolSize: 6
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Price Deviation Chart
        function initializePriceDeviationChart(range = '24h') {
            const chart = echarts.init(document.getElementById('priceDeviationChart'));
            
            // Get data from price comparison chart
            const priceChart = echarts.getInstanceByDom(document.getElementById('priceComparisonChart'));
            if (!priceChart) return;
            
            const priceOption = priceChart.getOption();
            const dates = priceOption.xAxis[0].data;
            const actualPrices = priceOption.series[0].data;
            const predictedPrices = priceOption.series[1].data;
            
            // Calculate deviations
            const deviations = [];
            for (let i = 0; i < actualPrices.length; i++) {
                deviations.push(predictedPrices[i] - actualPrices[i]);
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        const value = params[0].value;
                        const color = value > 0 ? '#ff3b30' : '#00ff88';
                        const prefix = value > 0 ? '+' : '';
                        return params[0].name + '<br>' +
                               'åå·®: <span style="color:' + color + '">' + prefix + '$' + value + '/MWh</span>';
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'åå·® ($/MWh)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        formatter: function(value) {
                            return value > 0 ? '+$' + value : '$' + value;
                        }
                    },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'ä»·æ ¼åå·®',
                        type: 'line',
                        data: deviations,
                        smooth: true,
                        lineStyle: { 
                            color: '#ff9500', 
                            width: 2
                        },
                        itemStyle: {
                            color: function(params) {
                                return params.value > 0 ? '#ff3b30' : '#00ff88';
                            }
                        },
                        symbolSize: 8,
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(255,149,0,0.2)' },
                                { offset: 0.5, color: 'rgba(255,149,0,0.1)' },
                                { offset: 1, color: 'rgba(255,149,0,0.05)' }
                            ])
                        },
                        markLine: {
                            symbol: 'none',
                            data: [
                                {
                                    yAxis: 0,
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.3)',
                                        type: 'dashed',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'åŸºå‡†çº¿',
                                        color: 'rgba(255,255,255,0.5)'
                                    }
                                }
                            ]
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Deviation Trend Chart
        function initializeDeviationTrendChart(range = '24h') {
            const chart = echarts.init(document.getElementById('deviationTrendChart'));
            
            const dates = [];
            const predictionAccuracy = [];
            
            // Generate data based on time range
            let dataPoints, timeFormat;
            switch(range) {
                case '24h':
                    dataPoints = 24;
                    timeFormat = (i) => `${i}:00`;
                    break;
                case '7d':
                    dataPoints = 7;
                    timeFormat = (i) => {
                        const date = new Date();
                        date.setDate(date.getDate() - (6 - i));
                        return date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' });
                    };
                    break;
                case '30d':
                default:
                    dataPoints = 30;
                    timeFormat = (i) => {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        return date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' });
                    };
                    break;
            }
            
            // Generate prediction accuracy data
            for (let i = 0; i < dataPoints; i++) {
                dates.push(timeFormat(i));
                
                // Generate accuracy between 92-98%
                const accuracy = 94 + Math.sin(i / 3) * 2 + Math.random() * 2;
                predictionAccuracy.push(accuracy.toFixed(1));
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        return params[0].name + '<br>' +
                               params[0].marker + params[0].seriesName + ': ' + params[0].value + '%';
                    }
                },
                legend: {
                    data: ['é¢„æµ‹å‡†ç¡®ç‡'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'å‡†ç¡®ç‡ (%)',
                    min: 90,
                    max: 100,
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        formatter: '{value}%'
                    },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'é¢„æµ‹å‡†ç¡®ç‡',
                        type: 'line',
                        data: predictionAccuracy,
                        smooth: true,
                        lineStyle: { 
                            color: '#ffd700', 
                            width: 2,
                            type: 'dashed'
                        },
                        itemStyle: { color: '#ffd700' },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(255,215,0,0.3)' },
                                { offset: 1, color: 'rgba(255,215,0,0.05)' }
                            ])
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Supply Demand Gap Chart
        async function initializeSupplyDemandGapChart(range = '24h') {
            const chart = echarts.init(document.getElementById('supplyDemandGapChart'));
            
            // Show loading
            chart.showLoading('default', {
                text: 'æ­£åœ¨è·å–AEMOå®æ—¶æ•°æ®...',
                color: '#00ff88',
                textColor: '#fff',
                maskColor: 'rgba(0, 0, 0, 0.8)',
                zlevel: 0
            });
            
            try {
                const aemoData = await fetchAEMOData(range);
                const { times, demand, generation, gap } = aemoData;
                
                chart.hideLoading();
                renderSupplyDemandChart(chart, times, demand, generation, gap);
            } catch (error) {
                console.error('Failed to fetch AEMO data:', error);
                chart.hideLoading();
                
                // Use realistic supply-demand data
                const supplyDemandData = generateSupplyDemandData();
                renderSupplyDemandChart(chart, supplyDemandData.times, supplyDemandData.demand, supplyDemandData.generation, supplyDemandData.gap);
            }
        }
        
        // Fetch real AEMO data
        async function fetchAEMOData(range) {
            const region = 'NSW1'; // New South Wales as example
            const endTime = new Date();
            const startTime = new Date(endTime.getTime() - (24 * 60 * 60 * 1000)); // 24 hours ago
            
            // Format dates for AEMO API (ISO format)
            const startTimeStr = startTime.toISOString().slice(0, -5) + 'Z';
            const endTimeStr = endTime.toISOString().slice(0, -5) + 'Z';
            
            // AEMO API endpoints
            const demandUrl = `https://visualisations.aemo.com.au/aemo/apps/api/report/5MIN?filter=REGION%20eq%20'${region}'%20and%20SETTLEMENTDATE%20ge%20datetime'${startTimeStr}'%20and%20SETTLEMENTDATE%20le%20datetime'${endTimeStr}'`;
            const generationUrl = `https://visualisations.aemo.com.au/aemo/apps/api/report/DISPATCH_UNIT_SCADA?filter=REGION%20eq%20'${region}'%20and%20SETTLEMENTDATE%20ge%20datetime'${startTimeStr}'%20and%20SETTLEMENTDATE%20le%20datetime'${endTimeStr}'`;
            
            try {
                // Note: Due to CORS restrictions, you may need to use a proxy server
                // For demo purposes, we'll use fetch with no-cors mode or implement fallback
                const demandResponse = await fetch(demandUrl, { 
                    mode: 'cors',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!demandResponse.ok) {
                    throw new Error('AEMO API request failed');
                }
                
                const demandData = await demandResponse.json();
                
                // Process AEMO data
                return processAEMOData(demandData);
                
            } catch (error) {
                // If direct API call fails due to CORS, fall back to realistic mock data
                throw new Error('AEMO API access blocked by CORS - using fallback data');
            }
        }
        
        // Process real AEMO data
        function processAEMOData(rawData) {
            const times = [];
            const demand = [];
            const generation = [];
            const gap = [];
            
            // Group data by hour and aggregate
            const hourlyData = {};
            
            rawData.forEach(record => {
                const date = new Date(record.SETTLEMENTDATE);
                const hour = date.getHours();
                const hourKey = `${hour}:00`;
                
                if (!hourlyData[hourKey]) {
                    hourlyData[hourKey] = {
                        totalDemand: 0,
                        totalGeneration: 0,
                        count: 0
                    };
                }
                
                hourlyData[hourKey].totalDemand += record.TOTALDEMAND || 0;
                hourlyData[hourKey].totalGeneration += record.AVAILABLEGENERATION || 0;
                hourlyData[hourKey].count++;
            });
            
            // Convert to arrays
            for (let i = 0; i < 24; i++) {
                const hourKey = `${i}:00`;
                times.push(hourKey);
                
                if (hourlyData[hourKey]) {
                    const avgDemand = Math.round(hourlyData[hourKey].totalDemand / hourlyData[hourKey].count);
                    const avgGeneration = Math.round(hourlyData[hourKey].totalGeneration / hourlyData[hourKey].count);
                    
                    demand.push(avgDemand);
                    generation.push(avgGeneration);
                    gap.push(avgDemand - avgGeneration);
                } else {
                    // Fill missing hours with interpolated data
                    demand.push(0);
                    generation.push(0);
                    gap.push(0);
                }
            }
            
            return { times, demand, generation, gap };
        }
        
        // Generate realistic power supply and demand data
        function generateSupplyDemandData() {
            const times = [];
            const demandData = [];
            const generationData = [];
            const gapData = [];
            
            // çœŸå®çš„24å°æ—¶éœ€æ±‚é‡æ•°æ® (MW) - åŸºäºå…¸å‹å·¥ä¸šåŸå¸‚ç”¨ç”µæ¨¡å¼
            const hourlyDemand = [
                5845,  // 0:00 - æ·±å¤œä½è°·
                5623,  // 1:00 - ç»§ç»­ä¸‹é™
                5412,  // 2:00 - æœ€ä½ç‚¹
                5389,  // 3:00 - ç»´æŒä½ä½
                5456,  // 4:00 - å¼€å§‹å›å‡
                5789,  // 5:00 - æ—©æœŸå·¥ä¸šå¯åŠ¨
                6234,  // 6:00 - æ—©é«˜å³°å¼€å§‹
                6892,  // 7:00 - ä¸Šç­é«˜å³°
                7456,  // 8:00 - å·¥ä¸šå…¨å¼€
                7823,  // 9:00 - å•†ä¸šæ´»åŠ¨å¢åŠ 
                8156,  // 10:00 - ä¸ŠåˆåŠå…¬é«˜å³°
                8234,  // 11:00 - ç»´æŒé«˜ä½
                8198,  // 12:00 - åˆé¤æ—¶æ®µ
                8067,  // 13:00 - åˆåå›è½
                8234,  // 14:00 - ä¸‹åˆåŠå…¬
                8345,  // 15:00 - å·¥ä¸šç»§ç»­
                8567,  // 16:00 - å‡†å¤‡ä¸‹ç­
                8923,  // 17:00 - ä¸‹ç­é«˜å³°
                9234,  // 18:00 - æ™šé«˜å³°å¼€å§‹
                9567,  // 19:00 - å±…æ°‘ç”¨ç”µé«˜å³°
                9234,  // 20:00 - ç»§ç»­é«˜ä½
                8567,  // 21:00 - å¼€å§‹å›è½
                7234,  // 22:00 - å¤œé—´ä¸‹é™
                6234   // 23:00 - å‡†å¤‡è¿›å…¥ä½è°·
            ];
            
            // çœŸå®çš„24å°æ—¶å‘ç”µé‡æ•°æ® (MW) - è€ƒè™‘å‘ç”µè®¡åˆ’å’Œè°ƒåº¦
            const hourlyGeneration = [
                6012,  // 0:00 - åŸºè½½+å°‘é‡è°ƒå³°
                5834,  // 1:00 - å‡å°‘è°ƒå³°æœºç»„
                5567,  // 2:00 - æœ€å°å‘ç”µç»„åˆ
                5523,  // 3:00 - ç»´æŒæœ€ä½
                5678,  // 4:00 - å‡†å¤‡å¢åŠ 
                5934,  // 5:00 - å¯åŠ¨è°ƒå³°æœºç»„
                6456,  // 6:00 - æ—©é«˜å³°å‡†å¤‡
                7123,  // 7:00 - å¿«é€Ÿçˆ¬å¡
                7678,  // 8:00 - å¢åŠ ç‡ƒæ°”æœºç»„
                8045,  // 9:00 - æ¥è¿‘å³°å€¼
                8345,  // 10:00 - å³°å€¼è¿è¡Œ
                8456,  // 11:00 - ç»´æŒé«˜å‡ºåŠ›
                8389,  // 12:00 - ç•¥å¾®è°ƒæ•´
                8234,  // 13:00 - é€‚å½“é™ä½
                8367,  // 14:00 - ä¸‹åˆè°ƒæ•´
                8523,  // 15:00 - å‡†å¤‡æ™šé«˜å³°
                8734,  // 16:00 - å¢åŠ å‚¨å¤‡
                9156,  // 17:00 - æ™šé«˜å³°çˆ¬å¡
                9456,  // 18:00 - å³°å€¼å‘ç”µ
                9789,  // 19:00 - æœ€å¤§å‡ºåŠ›
                9456,  // 20:00 - ç»´æŒé«˜ä½
                8734,  // 21:00 - å¼€å§‹é™è´Ÿè·
                7456,  // 22:00 - å¤œé—´è°ƒæ•´
                6456   // 23:00 - å›åˆ°å¤œé—´æ¨¡å¼
            ];
            
            // ç”Ÿæˆæ•°æ®å¹¶è®¡ç®—çœŸå®ç¼ºå£
            for (let i = 0; i < 24; i++) {
                times.push(`${String(i).padStart(2, '0')}:00`);
                
                const demand = hourlyDemand[i];
                const generation = hourlyGeneration[i];
                const gap = demand - generation;  // çœŸå®è®¡ç®—ï¼šéœ€æ±‚ - å‘ç”µ
                
                demandData.push(demand);
                generationData.push(generation);
                gapData.push(gap);
            }
            
            // è¿”å›è®¡ç®—ç»“æœçš„è¯¦ç»†ä¿¡æ¯
            console.log('=== ä¾›éœ€å¹³è¡¡åˆ†ææŠ¥å‘Š ===');
            console.log('æ€»éœ€æ±‚é‡:', demandData.reduce((a, b) => a + b, 0), 'MWh');
            console.log('æ€»å‘ç”µé‡:', generationData.reduce((a, b) => a + b, 0), 'MWh');
            console.log('å¹³å‡ç¼ºå£:', (gapData.reduce((a, b) => a + b, 0) / 24).toFixed(0), 'MW');
            
            const positiveGaps = gapData.filter(gap => gap > 0);
            const negativeGaps = gapData.filter(gap => gap < 0);
            
            console.log('ä¾›åº”ä¸è¶³æ—¶æ®µ:', positiveGaps.length, 'å°æ—¶');
            console.log('ä¾›åº”è¿‡å‰©æ—¶æ®µ:', negativeGaps.length, 'å°æ—¶');
            console.log('æœ€å¤§ç¼ºå£:', Math.max(...gapData), 'MW');
            console.log('æœ€å¤§è¿‡å‰©:', Math.min(...gapData), 'MW');
            
            return { 
                times, 
                demand: demandData, 
                generation: generationData, 
                gap: gapData 
            };
        }
        
        // Render the chart with data
        function renderSupplyDemandChart(chart, times, demand, generation, gap) {
            const option = {
                title: {
                    text: 'å®æ—¶AEMOæ•°æ® - NSWç”µåŠ›å¸‚åœº',
                    subtext: 'æ•°æ®æº: AEMO Public API | æ›´æ–°æ—¶é—´: ' + new Date().toLocaleTimeString('zh-CN'),
                    textStyle: {
                        color: 'rgba(255,255,255,0.8)',
                        fontSize: 14
                    },
                    subtextStyle: {
                        color: 'rgba(255,255,255,0.5)',
                        fontSize: 12
                    },
                    top: 5,
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].name + '<br>';
                        let demand = 0, generation = 0, gap = 0;
                        
                        params.forEach(item => {
                            if (item.seriesName === 'éœ€æ±‚é‡') {
                                demand = item.value;
                                result += item.marker + item.seriesName + ': ' + item.value + ' MW<br>';
                            } else if (item.seriesName === 'å‘ç”µé‡') {
                                generation = item.value;
                                result += item.marker + item.seriesName + ': ' + item.value + ' MW<br>';
                            } else if (item.seriesName === 'ç¼ºå£') {
                                gap = item.value;
                                const color = item.value > 0 ? '#ff3b30' : '#00ff88';
                                const status = item.value > 0 ? 'ä¾›åº”ä¸è¶³' : 'ä¾›åº”è¿‡å‰©';
                                result += item.marker + item.seriesName + ': <span style="color:' + color + '">' + (item.value > 0 ? '+' : '') + item.value + ' MW (' + status + ')</span><br>';
                            }
                        });
                        
                        // æ˜¾ç¤ºè®¡ç®—å…¬å¼éªŒè¯
                        if (demand && generation) {
                            result += '<hr style="border-color: rgba(255,255,255,0.2); margin: 5px 0;">è®¡ç®—: ' + demand + ' - ' + generation + ' = ' + (demand - generation) + ' MW';
                        }
                        
                        return result;
                    }
                },
                legend: {
                    data: ['éœ€æ±‚é‡', 'å‘ç”µé‡', 'ç¼ºå£'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: times,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        interval: 2
                    }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'ç”µé‡ (MW)',
                        position: 'left',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: '{value}'
                        },
                        splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } },
                        min: 0,
                        max: 12000
                    },
                    {
                        type: 'value',
                        name: 'ç¼ºå£ (MW)',
                        position: 'right',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: function(value) {
                                return value > 0 ? '+' + value : value;
                            }
                        },
                        splitLine: { show: false },
                        min: -300,
                        max: 600
                    }
                ],
                series: [
                    {
                        name: 'éœ€æ±‚é‡',
                        type: 'line',
                        data: demand,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 4,
                        lineStyle: { 
                            color: '#5470c6', 
                            width: 3
                        },
                        itemStyle: { color: '#5470c6' }
                    },
                    {
                        name: 'å‘ç”µé‡',
                        type: 'line',
                        data: generation,
                        smooth: true,
                        symbol: 'none',
                        lineStyle: { 
                            color: '#91cc75', 
                            width: 2
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(145,204,117,0.8)' },
                                { offset: 1, color: 'rgba(145,204,117,0.3)' }
                            ])
                        },
                        itemStyle: { color: '#91cc75' }
                    },
                    {
                        name: 'ç¼ºå£',
                        type: 'line',
                        yAxisIndex: 1,
                        data: gap,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 4,
                        lineStyle: { 
                            color: '#ff9500', 
                            width: 2
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(255,149,0,0.6)' },
                                { offset: 1, color: 'rgba(255,149,0,0.2)' }
                            ])
                        },
                        itemStyle: {
                            color: function(params) {
                                return params.value > 0 ? '#ff3b30' : '#00ff88';
                            }
                        },
                        markLine: {
                            symbol: 'none',
                            data: [
                                {
                                    yAxis: 0,
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.3)',
                                        type: 'dashed',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'å¹³è¡¡çº¿',
                                        color: 'rgba(255,255,255,0.5)'
                                    }
                                }
                            ]
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Supply Demand Gap Chart
        function initializeSupplyDemandGapChart(range = '24h') {
            const chart = echarts.init(document.getElementById('supplyDemandGapChart'));
            
            const times = [];
            const demandData = [];
            const generationData = [];
            const gapData = [];
            
            // ç”Ÿæˆ24å°æ—¶éœ€æ±‚é‡æ•°æ® (MW) - å…¸å‹å·¥ä½œæ—¥ç”¨ç”µæ¨¡å¼
            const hourlyDemand = [
                5480,  // 00:00 - æ·±å¤œä½è°·
                5320,  // 01:00 - ç»§ç»­ä¸‹é™
                5180,  // 02:00 - æœ€ä½ç‚¹
                5250,  // 03:00 - ç»´æŒä½ä½
                5420,  // 04:00 - å¼€å§‹å›å‡
                5880,  // 05:00 - æ—©æœŸå¯åŠ¨
                6780,  // 06:00 - æ—©é«˜å³°å¼€å§‹
                7850,  // 07:00 - ä¸Šç­é«˜å³°
                8650,  // 08:00 - å·¥ä¸šå…¨å¼€
                9120,  // 09:00 - å•†ä¸šæ´»åŠ¨å¢åŠ 
                9480,  // 10:00 - ä¸ŠåˆåŠå…¬é«˜å³°
                9720,  // 11:00 - ç»´æŒé«˜ä½
                9650,  // 12:00 - åˆé¤æ—¶æ®µ
                9380,  // 13:00 - åˆåå›è½
                9580,  // 14:00 - ä¸‹åˆåŠå…¬
                9850,  // 15:00 - å·¥ä¸šç»§ç»­
                10200, // 16:00 - å‡†å¤‡ä¸‹ç­
                10650, // 17:00 - ä¸‹ç­é«˜å³°
                11150, // 18:00 - æ™šé«˜å³°å¼€å§‹
                11580, // 19:00 - å±…æ°‘ç”¨ç”µé«˜å³°
                11220, // 20:00 - æŒç»­é«˜ä½
                10450, // 21:00 - å¼€å§‹å›è½
                8950,  // 22:00 - å¤œé—´ä¸‹é™
                7200   // 23:00 - å‡†å¤‡è¿›å…¥ä½è°·
            ];
            
            // ç”Ÿæˆ24å°æ—¶å‘ç”µé‡æ•°æ® (MW) - å‘ç”µè°ƒåº¦ç­–ç•¥
            const hourlyGeneration = [
                5680,  // 00:00 - åŸºè½½+å‚¨èƒ½(è¿‡å‰©)
                5450,  // 01:00 - å‡å°‘è°ƒå³°æœºç»„(è¿‡å‰©)
                5280,  // 02:00 - æœ€å°å‘ç”µç»„åˆ(è¿‡å‰©)
                5150,  // 03:00 - ç»´æŒæœ€ä½(ç¼ºå£)
                5350,  // 04:00 - å‡†å¤‡å¢åŠ (ç¼ºå£)
                5780,  // 05:00 - å¯åŠ¨è°ƒå³°æœºç»„(ç¼ºå£)
                6650,  // 06:00 - æ—©é«˜å³°å‡†å¤‡(ç¼ºå£)
                7720,  // 07:00 - å¿«é€Ÿçˆ¬å¡(ç¼ºå£)
                8480,  // 08:00 - å¢åŠ ç‡ƒæ°”æœºç»„(ç¼ºå£)
                8950,  // 09:00 - æ¥è¿‘å³°å€¼(ç¼ºå£)
                9280,  // 10:00 - å³°å€¼è¿è¡Œ(ç¼ºå£)
                9520,  // 11:00 - ç»´æŒé«˜å‡ºåŠ›(ç¼ºå£)
                9450,  // 12:00 - ç•¥å¾®è°ƒæ•´(ç¼ºå£)
                9180,  // 13:00 - é€‚å½“é™ä½(ç¼ºå£)
                9380,  // 14:00 - ä¸‹åˆè°ƒæ•´(ç¼ºå£)
                9650,  // 15:00 - å‡†å¤‡æ™šé«˜å³°(ç¼ºå£)
                9980,  // 16:00 - å¢åŠ å‚¨å¤‡(ç¼ºå£)
                10420, // 17:00 - æ™šé«˜å³°çˆ¬å¡(ç¼ºå£)
                10920, // 18:00 - å³°å€¼å‘ç”µ(ç¼ºå£)
                11350, // 19:00 - æœ€å¤§å‡ºåŠ›(ç¼ºå£)
                10980, // 20:00 - ç»´æŒé«˜ä½(ç¼ºå£)
                10220, // 21:00 - å¼€å§‹é™è´Ÿè·(ç¼ºå£)
                8750,  // 22:00 - å¤œé—´è°ƒæ•´(ç¼ºå£)
                7080   // 23:00 - å›åˆ°å¤œé—´æ¨¡å¼(ç¼ºå£)
            ];
            
            // ç”Ÿæˆæ•°æ®å¹¶è®¡ç®—çœŸå®ç¼ºå£
            for (let i = 0; i < 24; i++) {
                times.push(`${String(i).padStart(2, '0')}:00`);
                
                const demand = hourlyDemand[i];
                const generation = hourlyGeneration[i];
                const gap = demand - generation;  // ç¼ºå£ = éœ€æ±‚ - å‘ç”µ
                
                demandData.push(demand);
                generationData.push(generation);
                gapData.push(gap);
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].name + '<br>';
                        let demand = 0, generation = 0, gap = 0;
                        
                        params.forEach(item => {
                            if (item.seriesName === 'éœ€æ±‚é‡') {
                                demand = item.value;
                                result += item.marker + item.seriesName + ': ' + item.value + ' MW<br>';
                            } else if (item.seriesName === 'å‘ç”µé‡') {
                                generation = item.value;
                                result += item.marker + item.seriesName + ': ' + item.value + ' MW<br>';
                            } else if (item.seriesName === 'ç¼ºå£') {
                                gap = item.value;
                                const color = item.value > 0 ? '#ff3b30' : '#00ff88';
                                const status = item.value > 0 ? 'ä¾›åº”ä¸è¶³' : 'ä¾›åº”è¿‡å‰©';
                                result += item.marker + item.seriesName + ': <span style="color:' + color + '">' + (item.value > 0 ? '+' : '') + item.value + ' MW (' + status + ')</span><br>';
                            }
                        });
                        
                        // æ˜¾ç¤ºè®¡ç®—å…¬å¼éªŒè¯
                        if (demand && generation) {
                            result += '<hr style="border-color: rgba(255,255,255,0.2); margin: 5px 0;">è®¡ç®—: ' + demand + ' - ' + generation + ' = ' + (demand - generation) + ' MW';
                        }
                        
                        return result;
                    }
                },
                legend: {
                    data: ['éœ€æ±‚é‡', 'å‘ç”µé‡', 'ç¼ºå£'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: times,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        interval: 2
                    }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'ç”µé‡ (MW)',
                        position: 'left',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: '{value}'
                        },
                        splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } },
                        min: 4000,
                        max: 12000
                    },
                    {
                        type: 'value',
                        name: 'ç¼ºå£ (MW)',
                        position: 'right',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: function(value) {
                                return value > 0 ? '+' + value : value;
                            }
                        },
                        splitLine: { show: false },
                        min: -300,
                        max: 400
                    }
                ],
                series: [
                    {
                        name: 'éœ€æ±‚é‡',
                        type: 'line',
                        data: demandData,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 4,
                        lineStyle: { 
                            color: '#5470c6', 
                            width: 3
                        },
                        itemStyle: { color: '#5470c6' }
                    },
                    {
                        name: 'å‘ç”µé‡',
                        type: 'line',
                        data: generationData,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 4,
                        lineStyle: { 
                            color: '#91cc75', 
                            width: 3
                        },
                        itemStyle: { color: '#91cc75' }
                    },
                    {
                        name: 'ç¼ºå£',
                        type: 'line',
                        yAxisIndex: 1,
                        data: gapData,
                        smooth: true,
                        symbol: 'none',
                        lineStyle: { 
                            color: '#ff9500', 
                            width: 2
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(255,149,0,0.4)' },
                                { offset: 1, color: 'rgba(255,149,0,0.1)' }
                            ])
                        },
                        itemStyle: {
                            color: function(params) {
                                return params.value > 0 ? '#ff3b30' : '#00ff88';
                            }
                        },
                        markLine: {
                            symbol: 'none',
                            data: [
                                {
                                    yAxis: 0,
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.3)',
                                        type: 'dashed',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'å¹³è¡¡çº¿',
                                        color: 'rgba(255,255,255,0.5)'
                                    }
                                }
                            ]
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Prediction Deviation Heatmap
        function initializePredictionDeviationHeatmap(range = '24h') {
            const chart = echarts.init(document.getElementById('predictionDeviationHeatmap'));
            
            const hours = [];
            const regions = ['NSW1', 'QLD1', 'SA1', 'TAS1', 'VIC1'];
            const heatmapData = [];
            
            for (let i = 0; i < 24; i++) {
                hours.push(`${i}:00`);
                for (let j = 0; j < regions.length; j++) {
                    const value = Math.random() * 400 - 50;
                    heatmapData.push([i, j, value.toFixed(2)]);
                }
            }

            const option = {
                tooltip: {
                    position: 'top',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        return `${hours[params.value[0]]} ${regions[params.value[1]]}<br>åå·®ç‡: ${params.value[2]}%`;
                    }
                },
                grid: {
                    height: '80%',
                    top: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: hours,
                    splitArea: {
                        show: true
                    },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: {
                    type: 'category',
                    data: regions,
                    splitArea: {
                        show: true
                    },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                visualMap: {
                    min: -50,
                    max: 400,
                    calculable: true,
                    orient: 'horizontal',
                    left: 'center',
                    bottom: '0%',
                    textStyle: { color: '#999' },
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                    }
                },
                series: [{
                    name: 'é¢„æµ‹åå·®ç‡',
                    type: 'heatmap',
                    data: heatmapData,
                    label: {
                        show: false
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Hourly Deviation Chart
        function initializeHourlyDeviationChart(range = '24h') {
            const chart = echarts.init(document.getElementById('hourlyDeviationChart'));
            
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
            const avgDeviation = [
                5.2, 4.8, 4.5, 4.2, 4.0, 4.5, 6.8, 8.9, 9.2, 7.5, 6.3, 5.8,
                5.5, 5.2, 5.8, 7.2, 9.8, 10.5, 8.7, 7.2, 6.5, 5.8, 5.5, 5.2
            ];
            const maxDeviation = avgDeviation.map(v => v + Math.random() * 5 + 2);
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    data: ['å¹³å‡åå·®', 'æœ€å¤§åå·®'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: hours,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: {
                    type: 'value',
                    name: 'ä»·æ ¼åå·® ($/MWh)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'å¹³å‡åå·®',
                        type: 'bar',
                        data: avgDeviation,
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(30,127,255,0.8)' },
                                { offset: 1, color: 'rgba(30,127,255,0.3)' }
                            ])
                        }
                    },
                    {
                        name: 'æœ€å¤§åå·®',
                        type: 'line',
                        data: maxDeviation,
                        smooth: true,
                        lineStyle: { color: '#ff3b30', width: 2 },
                        itemStyle: { color: '#ff3b30' },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(255,59,48,0.2)' },
                                { offset: 1, color: 'rgba(255,59,48,0.05)' }
                            ])
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Operation Efficiency Chart
        function initializeOperationEfficiencyChart(range = '24h') {
            const chart = echarts.init(document.getElementById('operationEfficiencyChart'));
            
            const categories = ['å……ç”µå†³ç­–', 'æ”¾ç”µå†³ç­–', 'å®¹é‡åˆ†é…', 'å“åº”é€Ÿåº¦', 'æ‰§è¡Œç²¾åº¦'];
            const currentMonth = [95, 92, 76, 85, 98];
            const lastMonth = [92, 89, 72, 78, 96];
            const target = [98, 95, 85, 95, 99];
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    data: ['æœ¬æœˆ', 'ä¸Šæœˆ', 'ç›®æ ‡'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                radar: {
                    indicator: categories.map(cat => ({ name: cat, max: 100 })),
                    center: ['50%', '55%'],
                    radius: '70%',
                    axisName: {
                        color: 'rgba(255,255,255,0.7)'
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(255,255,255,0.1)'
                        }
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(255,255,255,0.02)', 'rgba(255,255,255,0.05)']
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(255,255,255,0.1)'
                        }
                    }
                },
                series: [
                    {
                        name: 'æ‰§è¡Œæ•ˆç‡',
                        type: 'radar',
                        data: [
                            {
                                value: currentMonth,
                                name: 'æœ¬æœˆ',
                                lineStyle: { color: '#00b96b', width: 2 },
                                areaStyle: { color: 'rgba(0,185,107,0.3)' }
                            },
                            {
                                value: lastMonth,
                                name: 'ä¸Šæœˆ',
                                lineStyle: { color: '#1e7fff', width: 2, type: 'dashed' },
                                areaStyle: { color: 'rgba(30,127,255,0.2)' }
                            },
                            {
                                value: target,
                                name: 'ç›®æ ‡',
                                lineStyle: { color: '#ff9500', width: 2, type: 'dotted' },
                                areaStyle: { color: 'rgba(255,149,0,0.1)' }
                            }
                        ]
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Selling Points Chart
        function initializeSellingPointsChart(range = '24h') {
            const chart = echarts.init(document.getElementById('sellingPointsChart'));
            
            // Generate time series data
            const hours = [];
            const prices = [];
            const forecast = [];
            const avgPrices = [];
            const sellingPoints = [];
            
            // Define selling periods and their areas
            const sellingPeriods = [
                { start: 7, end: 8.5, type: 'sell' },    // Morning selling period
                { start: 17, end: 18.5, type: 'sell' }   // Evening selling period
            ];
            
            for (let i = 0; i < 24; i++) {
                hours.push(`${i}:00`);
                
                // Generate realistic price pattern
                let price = 200; // Base price
                let forecastPrice = price;
                
                // Morning peak (7:00-9:00)
                if (i >= 6 && i <= 9) {
                    price = 200 + (i === 7 ? 220 : i === 8 ? 200 : 150);
                    forecastPrice = price + Math.random() * 20 - 10; // Â±10 deviation
                }
                // Noon moderate prices
                else if (i >= 10 && i <= 14) {
                    if (i === 12) {
                        price = 280;
                        forecastPrice = 285;
                    } else if (i === 13) {
                        price = 275;
                        forecastPrice = 280;
                    } else if (i === 14) {
                        price = 270;
                        forecastPrice = 275;
                    } else {
                        price = 200 + 100;
                        forecastPrice = price + Math.random() * 15 - 7.5;
                    }
                }
                // Evening peak (17:00-19:00) - Highest
                else if (i >= 16 && i <= 19) {
                    price = 200 + (i === 17 ? 250 : i === 18 ? 230 : 180);
                    forecastPrice = price + Math.random() * 25 - 12.5;
                }
                // Other times
                else {
                    price = 180 + Math.random() * 40;
                    forecastPrice = price + Math.random() * 15 - 7.5;
                }
                
                prices.push(price);
                forecast.push(forecastPrice);
                avgPrices.push(280); // Fixed average line
            }
            
            const option = {
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].axisValue + '<br>';
                        params.forEach(item => {
                            if (item.seriesName === 'å®é™…ç”µä»·') {
                                result += `å®é™…: $${item.value.toFixed(1)}/MWh<br>`;
                            } else if (item.seriesName === 'é¢„æµ‹ç”µä»·') {
                                result += `é¢„æµ‹: $${item.value.toFixed(1)}/MWh<br>`;
                            } else if (item.seriesName === 'å¹³å‡çº¿') {
                                result += `å‡ä»·: $${item.value.toFixed(1)}/MWh<br>`;
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['å®é™…ç”µä»·', 'é¢„æµ‹ç”µä»·', 'å¹³å‡çº¿'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10,
                    left: 'center'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: hours,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: {
                    type: 'value',
                    name: 'ç”µä»· ($/MWh)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        formatter: function(value) {
                            if (value >= 400) return `{excellent|${value}}`;
                            if (value >= 300) return `{good|${value}}`;
                            if (value >= 250) return `{average|${value}}`;
                            return `{improve|${value}}`;
                        },
                        rich: {
                            excellent: {
                                color: '#00ff88',
                                fontWeight: 'bold'
                            },
                            good: {
                                color: '#00b96b',
                                fontWeight: 'bold'
                            },
                            average: {
                                color: '#ff9500',
                                fontWeight: 'normal'
                            },
                            improve: {
                                color: '#ff3b30',
                                fontWeight: 'normal'
                            }
                        }
                    },
                    splitLine: { 
                        lineStyle: { 
                            color: function(value) {
                                if (value >= 400) return 'rgba(0,255,136,0.3)';
                                if (value >= 300) return 'rgba(0,185,107,0.2)';
                                if (value >= 250) return 'rgba(255,149,0,0.2)';
                                return 'rgba(255,59,48,0.2)';
                            }
                        }
                    },
                    splitArea: {
                        show: true,
                        areaStyle: {
                            color: [
                                'rgba(255,59,48,0.05)',   // 150-250: éœ€è¦æ”¹è¿› (çº¢è‰²ï¼Œä½é€æ˜åº¦)
                                'rgba(255,149,0,0.08)',   // 250-300: ä¸€èˆ¬ (æ©™è‰²)
                                'rgba(0,185,107,0.1)',    // 300-400: è‰¯å¥½ (ç»¿è‰²)
                                'rgba(0,255,136,0.15)'    // 400+: æœ€ä½³ (äº®ç»¿è‰²ï¼Œé«˜é€æ˜åº¦)
                            ]
                        }
                    },
                    min: 150,
                    max: 500
                },
                series: [
                    // ä¼˜ç§€å–ç”µåŒºåŸŸé¢ç§¯å›¾ (7-8ç‚¹å’Œ17-18ç‚¹)
                    {
                        name: 'ä¼˜ç§€å–ç”µåŒºåŸŸ',
                        type: 'line',
                        data: prices.map((price, index) => {
                            // åªåœ¨ä¼˜ç§€å–ç”µæ—¶æ®µæ˜¾ç¤ºæ•°æ®
                            if ((index >= 7 && index <= 8) || (index >= 17 && index <= 18)) {
                                return price;
                            }
                            return null;
                        }),
                        smooth: true,
                        lineStyle: { color: 'transparent' },
                        areaStyle: {
                            color: 'rgba(0,255,136,0.2)',
                            opacity: 0.6
                        },
                        symbol: 'none',
                        showInLegend: false
                    },
                    // ä¸€èˆ¬å–ç”µåŒºåŸŸé¢ç§¯å›¾ (13-14ç‚¹)
                    {
                        name: 'ä¸€èˆ¬å–ç”µåŒºåŸŸ',
                        type: 'line',
                        data: prices.map((price, index) => {
                            // åªåœ¨ä¸€èˆ¬å–ç”µæ—¶æ®µæ˜¾ç¤ºæ•°æ®
                            if (index >= 13 && index <= 14) {
                                return prices[index]; // ä½¿ç”¨å®é™…ä»·æ ¼
                            }
                            return null;
                        }),
                        smooth: true,
                        lineStyle: { color: 'transparent' },
                        areaStyle: {
                            color: 'rgba(255,149,0,0.2)',
                            opacity: 0.6
                        },
                        symbol: 'none',
                        showInLegend: false
                    },
                    // å®é™…ç”µä»·çº¿
                    {
                        name: 'å®é™…ç”µä»·',
                        type: 'line',
                        data: prices,
                        smooth: true,
                        lineStyle: { color: '#1e7fff', width: 3 },
                        itemStyle: { color: '#1e7fff' },
                        markPoint: {
                            symbol: 'circle',
                            symbolSize: 12,
                            label: {
                                show: true,
                                fontSize: 11,
                                fontWeight: 'bold',
                                color: '#fff',
                                backgroundColor: 'rgba(0,0,0,0.8)',
                                padding: [3, 6],
                                borderRadius: 4
                            },
                            data: [
                                {
                                    coord: [7, prices[7]],
                                    value: 'æ”¾',
                                    itemStyle: { color: '#00ff88', borderColor: '#fff', borderWidth: 2 }
                                },
                                {
                                    coord: [8, prices[8]],
                                    value: 'åœ',
                                    itemStyle: { color: '#ff3b30', borderColor: '#fff', borderWidth: 2 }
                                },
                                {
                                    coord: [13, 275],
                                    value: 'æ”¾',
                                    itemStyle: { color: '#ff9500', borderColor: '#fff', borderWidth: 2 }
                                },
                                {
                                    coord: [14, 270],
                                    value: 'åœ',
                                    itemStyle: { color: '#ff9500', borderColor: '#fff', borderWidth: 2 }
                                },
                                {
                                    coord: [17, prices[17]],
                                    value: 'æ”¾',
                                    itemStyle: { color: '#00ff88', borderColor: '#fff', borderWidth: 2 }
                                },
                                {
                                    coord: [18, prices[18]], 
                                    value: 'åœ',
                                    itemStyle: { color: '#ff3b30', borderColor: '#fff', borderWidth: 2 }
                                }
                            ]
                        }
                    },
                    // é¢„æµ‹ç”µä»·çº¿
                    {
                        name: 'é¢„æµ‹ç”µä»·',
                        type: 'line',
                        data: forecast,
                        smooth: true,
                        lineStyle: { 
                            color: '#ff9500', 
                            width: 2,
                            type: 'dashed'
                        },
                        itemStyle: { color: '#ff9500', opacity: 0.8 }
                    },
                    // å¹³å‡çº¿
                    {
                        name: 'å¹³å‡çº¿',
                        type: 'line',
                        data: avgPrices,
                        lineStyle: { 
                            color: 'rgba(255,255,255,0.5)', 
                            width: 1,
                            type: 'dotted'
                        },
                        itemStyle: { opacity: 0 }
                    }
                ],
                // Add bottom annotation for price zones
                graphic: [
                    {
                        type: 'text',
                        left: 'center',
                        bottom: 10,
                        style: {
                            text: 'ğŸŸ¢ $400+ æœ€ä½³  |  ğŸŸ¢ $300-400 è‰¯å¥½  |  ğŸŸ  $250-300 ä¸€èˆ¬  |  ğŸ”´ $150-250 éœ€è¦æ”¹è¿›',
                            fill: 'rgba(255,255,255,0.6)',
                            fontSize: 12,
                            fontFamily: 'sans-serif'
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Anomaly Distribution Chart
        function initializeAnomalyDistributionChart(range = '24h') {
            const chart = echarts.init(document.getElementById('anomalyDistributionChart'));
            
            const anomalyData = [
                { value: 28, name: 'å¤©æ°”çªå˜' },
                { value: 10, name: 'ç”µç½‘æ•…éšœ' },
                { value: 4, name: 'å¸‚åœºæ“çºµ' },
                { value: 6, name: 'éœ€æ±‚æ¿€å¢' },
                { value: 3, name: 'ä¾›ç»™ä¸­æ–­' }
            ];
            
            const option = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: '{b}: {c}æ¬¡ ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 'center'
                },
                series: [
                    {
                        name: 'å¼‚å¸¸äº‹ä»¶',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        center: ['60%', '50%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#000',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '20',
                                fontWeight: 'bold',
                                color: '#fff',
                                textBorderWidth: 0,
                                textBorderColor: 'transparent',
                                textShadowBlur: 0
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: anomalyData,
                        color: ['#00b96b', '#1e7fff', '#ff3b30', '#ff9500', '#af52de']
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Risk Impact Chart
        function initializeRiskImpactChart(range = '24h') {
            const chart = echarts.init(document.getElementById('riskImpactChart'));
            
            const riskTypes = ['æŠ€æœ¯æ•…éšœ', 'å¸‚åœºæ³¢åŠ¨', 'æ”¿ç­–å˜åŒ–', 'æç«¯å¤©æ°”', 'äººä¸ºé”™è¯¯'];
            const frequency = [2, 8, 3, 6, 1];
            const impact = [15, 85, 120, 65, 8];
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        return params[0].name + '<br>' +
                               params[0].marker + 'å‘ç”Ÿé¢‘ç‡: ' + params[0].value + 'æ¬¡<br>' +
                               params[1].marker + 'å¹³å‡æŸå¤±: $' + params[1].value + 'K';
                    }
                },
                legend: {
                    data: ['å‘ç”Ÿé¢‘ç‡', 'å¹³å‡æŸå¤±'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: riskTypes,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'å‘ç”Ÿé¢‘ç‡ (æ¬¡)',
                        position: 'left',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { color: 'rgba(255,255,255,0.5)' },
                        splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                    },
                    {
                        type: 'value',
                        name: 'å¹³å‡æŸå¤± ($K)',
                        position: 'right',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { color: 'rgba(255,255,255,0.5)' },
                        splitLine: { show: false }
                    }
                ],
                series: [
                    {
                        name: 'å‘ç”Ÿé¢‘ç‡',
                        type: 'bar',
                        data: frequency,
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(30,127,255,0.8)' },
                                { offset: 1, color: 'rgba(30,127,255,0.3)' }
                            ])
                        }
                    },
                    {
                        name: 'å¹³å‡æŸå¤±',
                        type: 'line',
                        yAxisIndex: 1,
                        data: impact,
                        smooth: true,
                        lineStyle: { color: '#ff3b30', width: 3 },
                        itemStyle: { color: '#ff3b30', borderWidth: 3 },
                        symbol: 'circle',
                        symbolSize: 10
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize all charts
        function initializeCharts() {
            // Clear existing chart instances
            const chartContainers = document.querySelectorAll('.chart-box');
            chartContainers.forEach(container => {
                const chartInstance = echarts.getInstanceByDom(container);
                if (chartInstance) {
                    chartInstance.dispose();
                }
            });

            // Initialize charts based on current dimension
            switch(currentDimension) {
                case 'price-forecast':
                    initializePriceComparisonChart(currentTimeDimension);
                    initializePredictionDeviationHeatmap(currentTimeDimension);
                    initializeSupplyDemandGapChart(currentTimeDimension);
                    initializeHourlyDeviationChart(currentTimeDimension);
                    break;
                case 'operation-execution':
                    initializeOperationEfficiencyChart(currentTimeDimension);
                    break;
                case 'operation-analysis':
                    initializeSellingPointsChart(currentTimeDimension);
                    break;
                case 'market-anomaly':
                    initializeAnomalyDistributionChart(currentTimeDimension);
                    break;
                case 'profit-analysis':
                    initializeRevenueBreakdownChart(currentTimeDimension);
                    initializeProfitTrendChart(currentTimeDimension);
                    initializeHourlyRevenueChart(currentTimeDimension);
                    break;
                case 'asset-performance':
                    initializeBatteryHealthChart(currentTimeDimension);
                    initializePerformanceTrendChart(currentTimeDimension);
                    initializeDegradationChart(currentTimeDimension);
                    break;
                case 'risk-control':
                    initializeRiskImpactChart(currentTimeDimension);
                    break;
                case 'user-analysis':
                    initializeUserCooperationChart(currentTimeDimension);
                    break;
            }
        }

        // Initialize Revenue Breakdown Chart
        function initializeRevenueBreakdownChart(range = '24h') {
            const chart = echarts.init(document.getElementById('revenueBreakdownChart'));
            
            const option = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: '{b}: ${c}K ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    right: '5%',
                    top: 'center',
                    textStyle: { color: 'rgba(255,255,255,0.7)' }
                },
                series: [
                    {
                        name: 'æ”¶ç›Šæ¥æº',
                        type: 'pie',
                        radius: ['45%', '75%'],
                        center: ['40%', '50%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#000',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '24',
                                fontWeight: 'bold',
                                color: '#fff',
                                textBorderWidth: 0,
                                textBorderColor: 'transparent',
                                textShadowBlur: 0
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            { value: 1468, name: 'ä»·æ ¼å¥—åˆ©', itemStyle: { color: '#00b96b' } },
                            { value: 284, name: 'å®¹é‡æœåŠ¡', itemStyle: { color: '#1e7fff' } },
                            { value: 118, name: 'è¾…åŠ©æœåŠ¡', itemStyle: { color: '#ff9500' } }
                        ]
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize User Cooperation Chart
        function initializeUserCooperationChart(range = '24h') {
            const chart = echarts.init(document.getElementById('userCooperationChart'));
            
            // ç”Ÿæˆ24å°æ—¶ç”¨æˆ·é…åˆåº¦æ•°æ®
            const times = [];
            const responseRate = [];
            const responseTime = [];
            const completionRate = [];
            
            for (let i = 0; i < 24; i++) {
                times.push(`${String(i).padStart(2, '0')}:00`);
                
                // æ¨¡æ‹ŸçœŸå®çš„ç”¨æˆ·é…åˆåº¦å˜åŒ–
                let baseRate = 90;
                let baseTime = 3;
                let baseCompletion = 95;
                
                // å·¥ä½œæ—¶é—´é…åˆåº¦æ›´é«˜
                if (i >= 8 && i <= 18) {
                    baseRate += 5 + Math.random() * 3;
                    baseTime -= 0.5 + Math.random() * 0.5;
                    baseCompletion += 2 + Math.random() * 2;
                } 
                // å¤œé—´é…åˆåº¦ç¨ä½
                else if (i >= 23 || i <= 6) {
                    baseRate -= 3 + Math.random() * 5;
                    baseTime += 1 + Math.random() * 2;
                    baseCompletion -= 1 + Math.random() * 3;
                }
                // å…¶ä»–æ—¶é—´æ­£å¸¸
                else {
                    baseRate += Math.random() * 4 - 2;
                    baseTime += Math.random() * 1 - 0.5;
                    baseCompletion += Math.random() * 2 - 1;
                }
                
                responseRate.push(Math.round(Math.max(75, Math.min(98, baseRate)) * 10) / 10);
                responseTime.push(Math.round(Math.max(1.5, Math.min(8, baseTime)) * 10) / 10);
                completionRate.push(Math.round(Math.max(85, Math.min(100, baseCompletion)) * 10) / 10);
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].name + '<br>';
                        params.forEach(item => {
                            if (item.seriesName === 'å“åº”ç‡') {
                                result += item.marker + item.seriesName + ': ' + item.value + '%<br>';
                            } else if (item.seriesName === 'å“åº”æ—¶é—´') {
                                result += item.marker + item.seriesName + ': ' + item.value + 'åˆ†é’Ÿ<br>';
                            } else if (item.seriesName === 'å®Œæˆç‡') {
                                result += item.marker + item.seriesName + ': ' + item.value + '%<br>';
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['å“åº”ç‡', 'å®Œæˆç‡', 'å“åº”æ—¶é—´'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: times,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        interval: 2
                    }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'ç™¾åˆ†æ¯” (%)',
                        position: 'left',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: '{value}%'
                        },
                        splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } },
                        min: 70,
                        max: 100
                    },
                    {
                        type: 'value',
                        name: 'æ—¶é—´ (åˆ†é’Ÿ)',
                        position: 'right',
                        nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                        axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                        axisLabel: { 
                            color: 'rgba(255,255,255,0.5)',
                            formatter: '{value}åˆ†é’Ÿ'
                        },
                        splitLine: { show: false },
                        min: 0,
                        max: 10
                    }
                ],
                series: [
                    {
                        name: 'å“åº”ç‡',
                        type: 'line',
                        data: responseRate,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: { 
                            color: '#00ff88', 
                            width: 3
                        },
                        itemStyle: { color: '#00ff88' },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(0,255,136,0.3)' },
                                { offset: 1, color: 'rgba(0,255,136,0.1)' }
                            ])
                        }
                    },
                    {
                        name: 'å®Œæˆç‡',
                        type: 'line',
                        data: completionRate,
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: { 
                            color: '#5470c6', 
                            width: 3
                        },
                        itemStyle: { color: '#5470c6' }
                    },
                    {
                        name: 'å“åº”æ—¶é—´',
                        type: 'line',
                        yAxisIndex: 1,
                        data: responseTime,
                        smooth: true,
                        symbol: 'diamond',
                        symbolSize: 8,
                        lineStyle: { 
                            color: '#ff9500', 
                            width: 2,
                            type: 'dashed'
                        },
                        itemStyle: { color: '#ff9500' }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Profit Trend Chart
        function initializeProfitTrendChart(range = '24h') {
            const chart = echarts.init(document.getElementById('profitTrendChart'));
            
            const dates = [];
            const actualProfit = [];
            const forecastProfit = [];
            
            // Generate data based on time range
            let dataPoints;
            switch(range) {
                case '24h':
                    dataPoints = 24;
                    for (let i = 0; i < dataPoints; i++) {
                        dates.push(`${i}:00`);
                        actualProfit.push(50 + Math.random() * 30);
                        forecastProfit.push(null);
                    }
                    // Add forecast
                    for (let i = 0; i < 6; i++) {
                        dates.push(`${dataPoints + i}:00`);
                        actualProfit.push(null);
                        forecastProfit.push(60 + Math.random() * 25);
                    }
                    break;
                case '7d':
                    dataPoints = 7;
                    for (let i = 0; i < dataPoints; i++) {
                        const date = new Date();
                        date.setDate(date.getDate() - (6 - i));
                        dates.push(date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }));
                        actualProfit.push(55 + Math.random() * 35);
                        forecastProfit.push(null);
                    }
                    break;
                case '30d':
                default:
                    dataPoints = 30;
                    for (let i = 0; i < dataPoints; i++) {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        dates.push(date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }));
                        actualProfit.push(45 + Math.random() * 40);
                        forecastProfit.push(null);
                    }
                    break;
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].name + '<br>';
                        params.forEach(item => {
                            if (item.value !== null) {
                                result += item.marker + item.seriesName + ': $' + item.value.toFixed(1) + 'K<br>';
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['å®é™…æ”¶ç›Š', 'é¢„æµ‹æ”¶ç›Š'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'æ”¶ç›Š ($K)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'å®é™…æ”¶ç›Š',
                        type: 'line',
                        data: actualProfit,
                        smooth: true,
                        lineStyle: { color: '#00b96b', width: 3 },
                        itemStyle: { color: '#00b96b' },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(0,185,107,0.3)' },
                                { offset: 1, color: 'rgba(0,185,107,0.05)' }
                            ])
                        }
                    },
                    {
                        name: 'é¢„æµ‹æ”¶ç›Š',
                        type: 'line',
                        data: forecastProfit,
                        smooth: true,
                        lineStyle: { color: '#1e7fff', width: 2, type: 'dashed' },
                        itemStyle: { color: '#1e7fff' }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Hourly Revenue Chart
        function initializeHourlyRevenueChart(range = '24h') {
            const chart = echarts.init(document.getElementById('hourlyRevenueChart'));
            
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
            const revenueData = [
                2.1, 1.8, 1.5, 1.2, 1.8, 2.5, 4.2, 6.8, 5.5, 4.3, 3.8, 3.2,
                3.5, 3.8, 4.5, 6.2, 8.5, 9.2, 7.8, 6.5, 5.2, 4.1, 3.2, 2.5
            ];
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: '{b0}<br>æ”¶ç›Š: ${c0}K'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: hours,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: {
                    type: 'value',
                    name: 'å°æ—¶æ”¶ç›Š ($K)',
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [{
                    type: 'bar',
                    data: revenueData,
                    itemStyle: {
                        color: function(params) {
                            const value = params.value;
                            if (value > 7) return '#ff3b30';
                            if (value > 5) return '#ff9500';
                            if (value > 3) return '#00b96b';
                            return '#1e7fff';
                        }
                    }
                }]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Battery Health Chart
        function initializeBatteryHealthChart(range = '24h') {
            const chart = echarts.init(document.getElementById('batteryHealthChart'));
            
            const option = {
                tooltip: {
                    formatter: '{a} <br/>{b} : {c}%'
                },
                series: [
                    {
                        name: 'ç”µæ± å¥åº·åº¦',
                        type: 'gauge',
                        radius: '80%',
                        center: ['25%', '50%'],
                        startAngle: 180,
                        endAngle: 0,
                        min: 0,
                        max: 100,
                        progress: {
                            show: true,
                            width: 20
                        },
                        axisLine: {
                            lineStyle: {
                                width: 20,
                                color: [[0.8, '#ff3b30'], [0.9, '#ff9500'], [1, '#00b96b']]
                            }
                        },
                        pointer: {
                            itemStyle: {
                                color: 'auto'
                            }
                        },
                        axisTick: {
                            distance: -20,
                            length: 8,
                            lineStyle: {
                                color: '#fff',
                                width: 2
                            }
                        },
                        splitLine: {
                            distance: -30,
                            length: 30,
                            lineStyle: {
                                color: '#fff',
                                width: 4
                            }
                        },
                        axisLabel: {
                            color: 'rgba(255,255,255,0.7)',
                            distance: 30,
                            fontSize: 12
                        },
                        detail: {
                            valueAnimation: true,
                            formatter: '{value}%',
                            color: '#fff',
                            fontSize: 24,
                            offsetCenter: [0, '70%']
                        },
                        data: [{
                            value: 94.2,
                            name: 'å®¹é‡ä¿æŒç‡'
                        }]
                    },
                    {
                        name: 'èƒ½é‡æ•ˆç‡',
                        type: 'gauge',
                        radius: '80%',
                        center: ['75%', '50%'],
                        startAngle: 180,
                        endAngle: 0,
                        min: 0,
                        max: 100,
                        progress: {
                            show: true,
                            width: 20
                        },
                        axisLine: {
                            lineStyle: {
                                width: 20,
                                color: [[0.7, '#ff3b30'], [0.85, '#ff9500'], [1, '#00b96b']]
                            }
                        },
                        pointer: {
                            itemStyle: {
                                color: 'auto'
                            }
                        },
                        axisTick: {
                            distance: -20,
                            length: 8,
                            lineStyle: {
                                color: '#fff',
                                width: 2
                            }
                        },
                        splitLine: {
                            distance: -30,
                            length: 30,
                            lineStyle: {
                                color: '#fff',
                                width: 4
                            }
                        },
                        axisLabel: {
                            color: 'rgba(255,255,255,0.7)',
                            distance: 30,
                            fontSize: 12
                        },
                        detail: {
                            valueAnimation: true,
                            formatter: '{value}%',
                            color: '#fff',
                            fontSize: 24,
                            offsetCenter: [0, '70%']
                        },
                        data: [{
                            value: 87.3,
                            name: 'å¾€è¿”æ•ˆç‡'
                        }]
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Performance Trend Chart
        function initializePerformanceTrendChart(range = '24h') {
            const chart = echarts.init(document.getElementById('performanceTrendChart'));
            
            const dates = [];
            const availability = [];
            const efficiency = [];
            const capacity = [];
            
            // Generate data
            let dataPoints;
            switch(range) {
                case '24h':
                    dataPoints = 24;
                    for (let i = 0; i < dataPoints; i++) {
                        dates.push(`${i}:00`);
                        availability.push(98 + Math.random() * 2);
                        efficiency.push(86 + Math.random() * 3);
                        capacity.push(94 - i * 0.01);
                    }
                    break;
                case '7d':
                    dataPoints = 7;
                    for (let i = 0; i < dataPoints; i++) {
                        const date = new Date();
                        date.setDate(date.getDate() - (6 - i));
                        dates.push(date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }));
                        availability.push(97 + Math.random() * 3);
                        efficiency.push(85 + Math.random() * 4);
                        capacity.push(94.5 - i * 0.05);
                    }
                    break;
                case '30d':
                default:
                    dataPoints = 30;
                    for (let i = 0; i < dataPoints; i++) {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        dates.push(date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }));
                        availability.push(96 + Math.random() * 4);
                        efficiency.push(84 + Math.random() * 5);
                        capacity.push(95 - i * 0.03);
                    }
                    break;
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    data: ['ç³»ç»Ÿå¯ç”¨ç‡', 'èƒ½é‡æ•ˆç‡', 'å®¹é‡ä¿æŒç‡'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'ç™¾åˆ†æ¯” (%)',
                    min: 80,
                    max: 100,
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'ç³»ç»Ÿå¯ç”¨ç‡',
                        type: 'line',
                        data: availability,
                        smooth: true,
                        lineStyle: { color: '#00b96b', width: 3 },
                        itemStyle: { color: '#00b96b' }
                    },
                    {
                        name: 'èƒ½é‡æ•ˆç‡',
                        type: 'line',
                        data: efficiency,
                        smooth: true,
                        lineStyle: { color: '#1e7fff', width: 3 },
                        itemStyle: { color: '#1e7fff' }
                    },
                    {
                        name: 'å®¹é‡ä¿æŒç‡',
                        type: 'line',
                        data: capacity,
                        smooth: true,
                        lineStyle: { color: '#ff9500', width: 3 },
                        itemStyle: { color: '#ff9500' }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Degradation Chart
        function initializeDegradationChart(range = '24h') {
            const chart = echarts.init(document.getElementById('degradationChart'));
            
            const months = [];
            const actualCapacity = [];
            const predictedCapacity = [];
            
            // Historical data
            for (let i = 0; i <= 12; i++) {
                months.push(`M${i}`);
                actualCapacity.push(100 - i * 0.48);
                predictedCapacity.push(null);
            }
            
            // Prediction
            for (let i = 13; i <= 60; i++) {
                months.push(`M${i}`);
                actualCapacity.push(null);
                predictedCapacity.push(100 - i * 0.5 - Math.pow(i/60, 2) * 5);
            }
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        let result = params[0].name + '<br>';
                        params.forEach(item => {
                            if (item.value !== null) {
                                result += item.marker + item.seriesName + ': ' + item.value.toFixed(1) + '%<br>';
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['å®é™…å®¹é‡', 'é¢„æµ‹å®¹é‡', 'æ›´æ¢é˜ˆå€¼'],
                    textStyle: { color: 'rgba(255,255,255,0.7)' },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: months,
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { 
                        color: 'rgba(255,255,255,0.5)',
                        interval: 5
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'å®¹é‡ (%)',
                    min: 70,
                    max: 100,
                    nameTextStyle: { color: 'rgba(255,255,255,0.5)' },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.05)' } }
                },
                series: [
                    {
                        name: 'å®é™…å®¹é‡',
                        type: 'line',
                        data: actualCapacity,
                        smooth: true,
                        lineStyle: { color: '#00b96b', width: 3 },
                        itemStyle: { color: '#00b96b' }
                    },
                    {
                        name: 'é¢„æµ‹å®¹é‡',
                        type: 'line',
                        data: predictedCapacity,
                        smooth: true,
                        lineStyle: { color: '#1e7fff', width: 2, type: 'dashed' },
                        itemStyle: { color: '#1e7fff' }
                    },
                    {
                        name: 'æ›´æ¢é˜ˆå€¼',
                        type: 'line',
                        markLine: {
                            data: [{ yAxis: 80 }],
                            lineStyle: { color: '#ff3b30', width: 2, type: 'dashed' },
                            label: {
                                formatter: 'æ›´æ¢é˜ˆå€¼: 80%',
                                color: '#ff3b30'
                            }
                        }
                    }
                ]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize Deviation Heatmap Chart
        function initializeDeviationHeatmap(range = '24h') {
            const chart = echarts.init(document.getElementById('deviationHeatmapChart'));
            
            // çƒ­åŠ›å›¾æ•°æ®
            const hours = [];
            const regions = ['NSW1', 'QLD1', 'SA1', 'TAS1', 'VIC1'];
            const heatmapData = [];
            
            for (let i = 0; i < 24; i++) {
                hours.push(`${i}:00`);
                for (let j = 0; j < regions.length; j++) {
                    // ç”Ÿæˆ-10%åˆ°+10%çš„åå·®ç‡
                    let deviation;
                    
                    // æ¨¡æ‹ŸçœŸå®çš„åå·®æ¨¡å¼
                    if (i >= 7 && i <= 9) { // æ—©é«˜å³°
                        deviation = (Math.random() - 0.5) * 15;
                    } else if (i >= 17 && i <= 19) { // æ™šé«˜å³°
                        deviation = (Math.random() - 0.5) * 18;
                    } else if (i >= 14 && i <= 16) { // åˆå
                        deviation = (Math.random() - 0.7) * 12;
                    } else if (i >= 0 && i <= 5) { // æ·±å¤œ
                        deviation = (Math.random() - 0.5) * 5;
                    } else {
                        deviation = (Math.random() - 0.5) * 10;
                    }
                    
                    heatmapData.push([i, j, deviation.toFixed(2)]);
                }
            }

            const option = {
                tooltip: {
                    position: 'top',
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    borderColor: 'rgba(255,255,255,0.1)',
                    textStyle: { color: '#fff' },
                    formatter: function(params) {
                        return `${hours[params.value[0]]} ${regions[params.value[1]]}<br>åå·®ç‡: ${params.value[2]}%`;
                    }
                },
                grid: {
                    height: '80%',
                    top: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: hours,
                    splitArea: {
                        show: true
                    },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                yAxis: {
                    type: 'category',
                    data: regions,
                    splitArea: {
                        show: true
                    },
                    axisLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: 'rgba(255,255,255,0.5)' }
                },
                visualMap: {
                    min: -10,
                    max: 10,
                    calculable: true,
                    orient: 'horizontal',
                    left: 'center',
                    bottom: '0%',
                    textStyle: { color: '#999' },
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                    }
                },
                series: [{
                    name: 'åå·®ç‡çƒ­åŠ›å›¾',
                    type: 'heatmap',
                    data: heatmapData,
                    label: {
                        show: false
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }
    </script>
</body>
</html>